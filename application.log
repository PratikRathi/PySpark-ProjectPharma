2024-04-14 12:19:59,719 - root - INFO - I am in the main method
2024-04-14 12:19:59,720 - root - INFO - Calling spark object
2024-04-14 12:19:59,720 - Create_spark - INFO - Creating spark object
2024-04-14 12:19:59,720 - Create_spark - INFO - Creating spark object
2024-04-14 12:19:59,720 - Create_spark - INFO - master is local
2024-04-14 12:19:59,720 - Create_spark - INFO - master is local
2024-04-14 12:20:06,581 - Create_spark - INFO - Spark object created
2024-04-14 12:20:06,581 - Create_spark - INFO - Spark object created
2024-04-14 12:20:06,581 - root - INFO - Validating spark object
2024-04-14 12:20:06,581 - Validate - WARNING - Started the spark object validation
2024-04-14 12:20:06,581 - Validate - WARNING - Started the spark object validation
2024-04-14 12:20:07,208 - Validate - WARNING - Validation completed
2024-04-14 12:20:07,208 - Validate - WARNING - Validation completed
2024-04-14 12:20:07,208 - root - INFO - reading file of format parquet from olap
2024-04-14 12:20:07,208 - Ingest - WARNING - load_files method started under /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 12:20:07,208 - Ingest - WARNING - load_files method started under /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 12:20:07,872 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 12:20:07,872 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 12:20:07,882 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 12:20:08,839 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 12:20:08,839 - Ingest - WARNING - counting number of records for df_city
2024-04-14 12:20:08,839 - Ingest - WARNING - counting number of records for df_city
2024-04-14 12:20:09,006 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 12:20:09,006 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 12:20:09,007 - root - INFO - reading file of format csv from oltp
2024-04-14 12:20:09,007 - Ingest - WARNING - load_files method started under /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 12:20:09,007 - Ingest - WARNING - load_files method started under /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 12:20:11,306 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 12:20:11,306 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 12:20:11,308 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 12:20:11,404 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 12:20:11,404 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 12:20:11,404 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 12:20:11,778 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 12:20:11,778 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 12:20:11,778 - root - INFO - Application done
2024-04-14 14:29:03,972 - root - INFO - I am in the main method
2024-04-14 14:29:03,972 - root - INFO - Calling spark object
2024-04-14 14:29:03,972 - Create_spark - INFO - Creating spark object
2024-04-14 14:29:03,972 - Create_spark - INFO - Creating spark object
2024-04-14 14:29:03,972 - Create_spark - INFO - master is local
2024-04-14 14:29:03,972 - Create_spark - INFO - master is local
2024-04-14 14:29:11,101 - Create_spark - INFO - Spark object created
2024-04-14 14:29:11,101 - Create_spark - INFO - Spark object created
2024-04-14 14:29:11,102 - root - INFO - Validating spark object
2024-04-14 14:29:11,103 - Validate - WARNING - Started the spark object validation
2024-04-14 14:29:11,103 - Validate - WARNING - Started the spark object validation
2024-04-14 14:29:11,756 - Validate - WARNING - Validation completed
2024-04-14 14:29:11,756 - Validate - WARNING - Validation completed
2024-04-14 14:29:11,756 - root - INFO - reading file of format parquet from olap
2024-04-14 14:29:11,757 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:29:11,757 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:29:12,716 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:29:12,716 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:29:12,728 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:29:14,354 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:29:14,354 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:29:14,354 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:29:14,528 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:29:14,528 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:29:14,528 - root - INFO - reading file of format csv from oltp
2024-04-14 14:29:14,528 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:29:14,528 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:29:16,958 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:29:16,958 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:29:16,960 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:29:17,071 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:29:17,072 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:29:17,072 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:29:17,450 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:29:17,450 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:29:17,450 - root - INFO - implementing data_processing
2024-04-14 14:29:17,451 - Processing - WARNING - data clean method started
2024-04-14 14:29:17,451 - Processing - WARNING - data clean method started
2024-04-14 14:29:17,477 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:29:17,477 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:30:18,132 - root - INFO - I am in the main method
2024-04-14 14:30:18,132 - root - INFO - Calling spark object
2024-04-14 14:30:18,132 - Create_spark - INFO - Creating spark object
2024-04-14 14:30:18,132 - Create_spark - INFO - Creating spark object
2024-04-14 14:30:18,132 - Create_spark - INFO - master is local
2024-04-14 14:30:18,132 - Create_spark - INFO - master is local
2024-04-14 14:30:25,087 - Create_spark - INFO - Spark object created
2024-04-14 14:30:25,087 - Create_spark - INFO - Spark object created
2024-04-14 14:30:25,087 - root - INFO - Validating spark object
2024-04-14 14:30:25,087 - Validate - WARNING - Started the spark object validation
2024-04-14 14:30:25,087 - Validate - WARNING - Started the spark object validation
2024-04-14 14:30:25,721 - Validate - WARNING - Validation completed
2024-04-14 14:30:25,721 - Validate - WARNING - Validation completed
2024-04-14 14:30:25,722 - root - INFO - reading file of format parquet from olap
2024-04-14 14:30:25,722 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:30:25,722 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:30:26,395 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:30:26,395 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:30:26,405 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:30:27,384 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:30:27,384 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:30:27,384 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:30:27,548 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:30:27,548 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:30:27,548 - root - INFO - reading file of format csv from oltp
2024-04-14 14:30:27,548 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:30:27,548 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:30:29,965 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:30:29,965 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:30:29,967 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:30:30,057 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:30:30,057 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:30:30,057 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:30:30,414 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:30:30,414 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:30:30,414 - root - INFO - implementing data_processing
2024-04-14 14:30:30,414 - Processing - WARNING - data clean method started
2024-04-14 14:30:30,414 - Processing - WARNING - data clean method started
2024-04-14 14:30:30,429 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:30:30,429 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:35:00,065 - root - INFO - I am in the main method
2024-04-14 14:35:00,065 - root - INFO - Calling spark object
2024-04-14 14:35:00,065 - Create_spark - INFO - Creating spark object
2024-04-14 14:35:00,065 - Create_spark - INFO - Creating spark object
2024-04-14 14:35:00,065 - Create_spark - INFO - master is local
2024-04-14 14:35:00,065 - Create_spark - INFO - master is local
2024-04-14 14:35:06,926 - Create_spark - INFO - Spark object created
2024-04-14 14:35:06,926 - Create_spark - INFO - Spark object created
2024-04-14 14:35:06,926 - root - INFO - Validating spark object
2024-04-14 14:35:06,926 - Validate - WARNING - Started the spark object validation
2024-04-14 14:35:06,926 - Validate - WARNING - Started the spark object validation
2024-04-14 14:35:07,561 - Validate - WARNING - Validation completed
2024-04-14 14:35:07,561 - Validate - WARNING - Validation completed
2024-04-14 14:35:07,561 - root - INFO - reading file of format parquet from olap
2024-04-14 14:35:07,561 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:35:07,561 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:35:08,270 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:35:08,270 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:35:08,280 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:35:09,745 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:35:09,745 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:35:09,745 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:35:09,932 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:35:09,932 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:35:09,933 - root - INFO - reading file of format csv from oltp
2024-04-14 14:35:09,933 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:35:09,933 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:35:12,191 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:35:12,191 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:35:12,192 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:35:12,285 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:35:12,285 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:35:12,285 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:35:12,639 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:35:12,639 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:35:12,639 - root - INFO - implementing data_processing
2024-04-14 14:35:12,639 - Processing - WARNING - data clean method started
2024-04-14 14:35:12,639 - Processing - WARNING - data clean method started
2024-04-14 14:35:12,654 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:35:12,654 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:36:06,190 - root - INFO - I am in the main method
2024-04-14 14:36:06,191 - root - INFO - Calling spark object
2024-04-14 14:36:06,191 - Create_spark - INFO - Creating spark object
2024-04-14 14:36:06,191 - Create_spark - INFO - Creating spark object
2024-04-14 14:36:06,191 - Create_spark - INFO - master is local
2024-04-14 14:36:06,191 - Create_spark - INFO - master is local
2024-04-14 14:36:12,927 - Create_spark - INFO - Spark object created
2024-04-14 14:36:12,927 - Create_spark - INFO - Spark object created
2024-04-14 14:36:12,927 - root - INFO - Validating spark object
2024-04-14 14:36:12,927 - Validate - WARNING - Started the spark object validation
2024-04-14 14:36:12,927 - Validate - WARNING - Started the spark object validation
2024-04-14 14:36:13,545 - Validate - WARNING - Validation completed
2024-04-14 14:36:13,545 - Validate - WARNING - Validation completed
2024-04-14 14:36:13,545 - root - INFO - reading file of format parquet from olap
2024-04-14 14:36:13,545 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:36:13,545 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:36:14,238 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:36:14,238 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:36:14,248 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:36:15,209 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:36:15,210 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:36:15,210 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:36:15,374 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:36:15,374 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:36:15,374 - root - INFO - reading file of format csv from oltp
2024-04-14 14:36:15,374 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:36:15,374 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:36:17,704 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:36:17,704 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:36:17,705 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:36:17,805 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:36:17,805 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:36:17,805 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:36:18,169 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:36:18,169 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:36:18,169 - root - INFO - implementing data_processing
2024-04-14 14:36:18,169 - Processing - WARNING - data clean method started
2024-04-14 14:36:18,169 - Processing - WARNING - data clean method started
2024-04-14 14:36:18,191 - Processing - WARNING - data cleaning completed
2024-04-14 14:36:18,191 - Processing - WARNING - data cleaning completed
2024-04-14 14:36:18,315 - root - INFO - Application done
2024-04-14 14:58:08,162 - root - INFO - I am in the main method
2024-04-14 14:58:08,163 - root - INFO - Calling spark object
2024-04-14 14:58:08,163 - Create_spark - INFO - Creating spark object
2024-04-14 14:58:08,163 - Create_spark - INFO - Creating spark object
2024-04-14 14:58:08,163 - Create_spark - INFO - master is local
2024-04-14 14:58:08,163 - Create_spark - INFO - master is local
2024-04-14 14:58:14,992 - Create_spark - INFO - Spark object created
2024-04-14 14:58:14,992 - Create_spark - INFO - Spark object created
2024-04-14 14:58:14,993 - root - INFO - Validating spark object
2024-04-14 14:58:14,993 - Validate - WARNING - Started the spark object validation
2024-04-14 14:58:14,993 - Validate - WARNING - Started the spark object validation
2024-04-14 14:58:15,610 - Validate - WARNING - Validation completed
2024-04-14 14:58:15,610 - Validate - WARNING - Validation completed
2024-04-14 14:58:15,611 - root - INFO - reading file of format parquet from olap
2024-04-14 14:58:15,611 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:58:15,611 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:58:16,302 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:58:16,302 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:58:16,313 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:58:17,263 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:58:17,264 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:58:17,264 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:58:17,446 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:58:17,446 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:58:17,446 - root - INFO - reading file of format csv from oltp
2024-04-14 14:58:17,446 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:58:17,446 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:58:19,693 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:58:19,693 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:58:19,695 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:58:19,787 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:58:19,787 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:58:19,787 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:58:20,133 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:58:20,133 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:58:20,133 - root - INFO - implementing data_processing
2024-04-14 14:58:20,133 - Processing - WARNING - data clean method started
2024-04-14 14:58:20,133 - Processing - WARNING - data clean method started
2024-04-14 14:58:20,162 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:58:20,162 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:58:40,780 - root - INFO - I am in the main method
2024-04-14 14:58:40,780 - root - INFO - Calling spark object
2024-04-14 14:58:40,780 - Create_spark - INFO - Creating spark object
2024-04-14 14:58:40,780 - Create_spark - INFO - Creating spark object
2024-04-14 14:58:40,780 - Create_spark - INFO - master is local
2024-04-14 14:58:40,780 - Create_spark - INFO - master is local
2024-04-14 14:58:47,094 - Create_spark - INFO - Spark object created
2024-04-14 14:58:47,094 - Create_spark - INFO - Spark object created
2024-04-14 14:58:47,094 - root - INFO - Validating spark object
2024-04-14 14:58:47,094 - Validate - WARNING - Started the spark object validation
2024-04-14 14:58:47,094 - Validate - WARNING - Started the spark object validation
2024-04-14 14:58:47,636 - Validate - WARNING - Validation completed
2024-04-14 14:58:47,636 - Validate - WARNING - Validation completed
2024-04-14 14:58:47,636 - root - INFO - reading file of format parquet from olap
2024-04-14 14:58:47,636 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:58:47,636 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 14:58:48,315 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:58:48,315 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 14:58:48,325 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:58:49,278 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 14:58:49,278 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:58:49,278 - Ingest - WARNING - counting number of records for df_city
2024-04-14 14:58:49,457 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:58:49,457 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 14:58:49,458 - root - INFO - reading file of format csv from oltp
2024-04-14 14:58:49,458 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:58:49,458 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 14:58:51,818 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:58:51,818 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 14:58:51,820 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:58:51,936 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 14:58:51,936 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:58:51,936 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 14:58:52,321 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:58:52,321 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 14:58:52,322 - root - INFO - implementing data_processing
2024-04-14 14:58:52,322 - Processing - WARNING - data clean method started
2024-04-14 14:58:52,322 - Processing - WARNING - data clean method started
2024-04-14 14:58:52,349 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:58:52,349 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 14:58:52,479 - root - INFO - Application done
2024-04-14 15:00:13,393 - root - INFO - I am in the main method
2024-04-14 15:00:13,393 - root - INFO - Calling spark object
2024-04-14 15:00:13,393 - Create_spark - INFO - Creating spark object
2024-04-14 15:00:13,393 - Create_spark - INFO - Creating spark object
2024-04-14 15:00:13,394 - Create_spark - INFO - master is local
2024-04-14 15:00:13,394 - Create_spark - INFO - master is local
2024-04-14 15:00:20,239 - Create_spark - INFO - Spark object created
2024-04-14 15:00:20,239 - Create_spark - INFO - Spark object created
2024-04-14 15:00:20,239 - root - INFO - Validating spark object
2024-04-14 15:00:20,239 - Validate - WARNING - Started the spark object validation
2024-04-14 15:00:20,239 - Validate - WARNING - Started the spark object validation
2024-04-14 15:00:20,856 - Validate - WARNING - Validation completed
2024-04-14 15:00:20,856 - Validate - WARNING - Validation completed
2024-04-14 15:00:20,857 - root - INFO - reading file of format parquet from olap
2024-04-14 15:00:20,857 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:00:20,857 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:00:21,579 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:00:21,579 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:00:21,593 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:00:22,568 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:00:22,568 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:00:22,568 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:00:22,748 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:00:22,748 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:00:22,748 - root - INFO - reading file of format csv from oltp
2024-04-14 15:00:22,748 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:00:22,748 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:00:25,070 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:00:25,070 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:00:25,071 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:00:25,181 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:00:25,181 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:00:25,181 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:00:25,727 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:00:25,727 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:00:25,727 - root - INFO - implementing data_processing
2024-04-14 15:00:25,727 - Processing - WARNING - data clean method started
2024-04-14 15:00:25,727 - Processing - WARNING - data clean method started
2024-04-14 15:00:25,763 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 15:00:25,763 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 15:00:25,899 - root - INFO - Application done
2024-04-14 15:19:15,147 - root - INFO - I am in the main method
2024-04-14 15:19:15,148 - root - INFO - Calling spark object
2024-04-14 15:19:15,148 - Create_spark - INFO - Creating spark object
2024-04-14 15:19:15,148 - Create_spark - INFO - Creating spark object
2024-04-14 15:19:15,148 - Create_spark - INFO - master is local
2024-04-14 15:19:15,148 - Create_spark - INFO - master is local
2024-04-14 15:19:21,971 - Create_spark - INFO - Spark object created
2024-04-14 15:19:21,971 - Create_spark - INFO - Spark object created
2024-04-14 15:19:21,971 - root - INFO - Validating spark object
2024-04-14 15:19:21,971 - Validate - WARNING - Started the spark object validation
2024-04-14 15:19:21,971 - Validate - WARNING - Started the spark object validation
2024-04-14 15:19:22,597 - Validate - WARNING - Validation completed
2024-04-14 15:19:22,597 - Validate - WARNING - Validation completed
2024-04-14 15:19:22,600 - root - INFO - reading file of format parquet from olap
2024-04-14 15:19:22,600 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:19:22,600 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:19:23,267 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:19:23,267 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:19:23,277 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:19:27,329 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:19:27,329 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:19:27,329 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:19:27,636 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:19:27,636 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:19:27,636 - root - INFO - reading file of format csv from oltp
2024-04-14 15:19:27,636 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:19:27,636 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:19:30,074 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:19:30,074 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:19:30,075 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:19:30,182 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:19:30,183 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:19:30,183 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:19:30,543 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:19:30,543 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:19:30,544 - root - INFO - implementing data_processing
2024-04-14 15:19:30,544 - Processing - WARNING - data clean method started
2024-04-14 15:19:30,544 - Processing - WARNING - data clean method started
2024-04-14 15:19:30,572 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 15:19:30,572 - Processing - ERROR - An error occured while cleaning the dataframes
2024-04-14 15:22:12,069 - root - INFO - I am in the main method
2024-04-14 15:22:12,070 - root - INFO - Calling spark object
2024-04-14 15:22:12,070 - Create_spark - INFO - Creating spark object
2024-04-14 15:22:12,070 - Create_spark - INFO - Creating spark object
2024-04-14 15:22:12,070 - Create_spark - INFO - master is local
2024-04-14 15:22:12,070 - Create_spark - INFO - master is local
2024-04-14 15:22:19,108 - Create_spark - INFO - Spark object created
2024-04-14 15:22:19,108 - Create_spark - INFO - Spark object created
2024-04-14 15:22:19,108 - root - INFO - Validating spark object
2024-04-14 15:22:19,108 - Validate - WARNING - Started the spark object validation
2024-04-14 15:22:19,108 - Validate - WARNING - Started the spark object validation
2024-04-14 15:22:19,804 - Validate - WARNING - Validation completed
2024-04-14 15:22:19,804 - Validate - WARNING - Validation completed
2024-04-14 15:22:19,804 - root - INFO - reading file of format parquet from olap
2024-04-14 15:22:19,804 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:22:19,804 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:22:20,388 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:22:20,388 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:22:20,401 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:22:21,356 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:22:21,357 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:22:21,357 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:22:21,540 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:22:21,540 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:22:21,540 - root - INFO - reading file of format csv from oltp
2024-04-14 15:22:21,540 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:22:21,540 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:22:24,011 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:22:24,011 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:22:24,013 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:22:24,114 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:22:24,114 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:22:24,114 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:22:24,486 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:22:24,486 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:22:24,486 - root - INFO - implementing data_processing
2024-04-14 15:22:24,486 - Processing - WARNING - data clean method started
2024-04-14 15:22:24,486 - Processing - WARNING - data clean method started
2024-04-14 15:22:24,532 - Processing - WARNING - data cleaning completed
2024-04-14 15:22:24,532 - Processing - WARNING - data cleaning completed
2024-04-14 15:22:24,669 - root - INFO - Application done
2024-04-14 15:27:34,456 - root - INFO - I am in the main method
2024-04-14 15:27:34,458 - root - INFO - Calling spark object
2024-04-14 15:27:34,458 - Create_spark - INFO - Creating spark object
2024-04-14 15:27:34,458 - Create_spark - INFO - Creating spark object
2024-04-14 15:27:34,458 - Create_spark - INFO - master is local
2024-04-14 15:27:34,458 - Create_spark - INFO - master is local
2024-04-14 15:27:41,293 - Create_spark - INFO - Spark object created
2024-04-14 15:27:41,293 - Create_spark - INFO - Spark object created
2024-04-14 15:27:41,293 - root - INFO - Validating spark object
2024-04-14 15:27:41,293 - Validate - WARNING - Started the spark object validation
2024-04-14 15:27:41,293 - Validate - WARNING - Started the spark object validation
2024-04-14 15:27:41,917 - Validate - WARNING - Validation completed
2024-04-14 15:27:41,917 - Validate - WARNING - Validation completed
2024-04-14 15:27:41,917 - root - INFO - reading file of format parquet from olap
2024-04-14 15:27:41,918 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:27:41,918 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:27:42,636 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:27:42,636 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:27:42,647 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:27:43,596 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:27:43,596 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:27:43,596 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:27:43,782 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:27:43,782 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:27:43,782 - root - INFO - reading file of format csv from oltp
2024-04-14 15:27:43,782 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:27:43,782 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:27:46,079 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:27:46,079 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:27:46,080 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:27:46,179 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:27:46,180 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:27:46,180 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:27:46,579 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:27:46,579 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:27:46,580 - root - INFO - implementing data_processing
2024-04-14 15:27:46,580 - Processing - WARNING - data clean method started
2024-04-14 15:27:46,580 - Processing - WARNING - data clean method started
2024-04-14 15:27:46,634 - Processing - WARNING - data cleaning completed
2024-04-14 15:27:46,634 - Processing - WARNING - data cleaning completed
2024-04-14 15:27:46,782 - root - INFO - Application done
2024-04-14 15:34:20,187 - root - INFO - I am in the main method
2024-04-14 15:34:20,188 - root - INFO - Calling spark object
2024-04-14 15:34:20,188 - Create_spark - INFO - Creating spark object
2024-04-14 15:34:20,188 - Create_spark - INFO - Creating spark object
2024-04-14 15:34:20,188 - Create_spark - INFO - master is local
2024-04-14 15:34:20,188 - Create_spark - INFO - master is local
2024-04-14 15:34:27,056 - Create_spark - INFO - Spark object created
2024-04-14 15:34:27,056 - Create_spark - INFO - Spark object created
2024-04-14 15:34:27,056 - root - INFO - Validating spark object
2024-04-14 15:34:27,056 - Validate - WARNING - Started the spark object validation
2024-04-14 15:34:27,056 - Validate - WARNING - Started the spark object validation
2024-04-14 15:34:27,705 - Validate - WARNING - Validation completed
2024-04-14 15:34:27,705 - Validate - WARNING - Validation completed
2024-04-14 15:34:27,706 - root - INFO - reading file of format parquet from olap
2024-04-14 15:34:27,706 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:34:27,706 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:34:28,456 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:34:28,456 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:34:28,468 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:34:29,950 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:34:29,950 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:34:29,950 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:34:30,238 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:34:30,238 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:34:30,239 - root - INFO - reading file of format csv from oltp
2024-04-14 15:34:30,239 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:34:30,239 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:34:32,684 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:34:32,684 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:34:32,686 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:34:32,790 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:34:32,790 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:34:32,790 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:34:33,174 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:34:33,174 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:34:33,174 - root - INFO - implementing data_processing
2024-04-14 15:34:33,174 - Processing - WARNING - data clean method started
2024-04-14 15:34:33,174 - Processing - WARNING - data clean method started
2024-04-14 15:34:33,269 - Processing - WARNING - data cleaning completed
2024-04-14 15:34:33,269 - Processing - WARNING - data cleaning completed
2024-04-14 15:34:33,418 - root - INFO - checking schema
2024-04-14 15:34:33,418 - Processing - WARNING - printing schema
2024-04-14 15:34:33,418 - Processing - WARNING - printing schema
2024-04-14 15:34:33,419 - Processing - WARNING - printing schema
2024-04-14 15:34:33,419 - Processing - WARNING - printing schema
2024-04-14 15:34:33,419 - root - INFO - Application done
2024-04-14 15:35:03,666 - root - INFO - I am in the main method
2024-04-14 15:35:03,667 - root - INFO - Calling spark object
2024-04-14 15:35:03,667 - Create_spark - INFO - Creating spark object
2024-04-14 15:35:03,667 - Create_spark - INFO - Creating spark object
2024-04-14 15:35:03,667 - Create_spark - INFO - master is local
2024-04-14 15:35:03,667 - Create_spark - INFO - master is local
2024-04-14 15:35:10,602 - Create_spark - INFO - Spark object created
2024-04-14 15:35:10,602 - Create_spark - INFO - Spark object created
2024-04-14 15:35:10,602 - root - INFO - Validating spark object
2024-04-14 15:35:10,602 - Validate - WARNING - Started the spark object validation
2024-04-14 15:35:10,602 - Validate - WARNING - Started the spark object validation
2024-04-14 15:35:11,254 - Validate - WARNING - Validation completed
2024-04-14 15:35:11,254 - Validate - WARNING - Validation completed
2024-04-14 15:35:11,255 - root - INFO - reading file of format parquet from olap
2024-04-14 15:35:11,255 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:35:11,255 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:35:11,860 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:35:11,860 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:35:11,871 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:35:12,937 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:35:12,937 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:35:12,937 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:35:13,171 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:35:13,171 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:35:13,171 - root - INFO - reading file of format csv from oltp
2024-04-14 15:35:13,171 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:35:13,171 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:35:15,631 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:35:15,631 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:35:15,632 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:35:15,739 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:35:15,739 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:35:15,739 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:35:16,093 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:35:16,093 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:35:16,093 - root - INFO - implementing data_processing
2024-04-14 15:35:16,093 - Processing - WARNING - data clean method started
2024-04-14 15:35:16,093 - Processing - WARNING - data clean method started
2024-04-14 15:35:16,148 - Processing - WARNING - data cleaning completed
2024-04-14 15:35:16,148 - Processing - WARNING - data cleaning completed
2024-04-14 15:35:16,269 - root - INFO - checking schema
2024-04-14 15:35:16,269 - Processing - WARNING - printing schema
2024-04-14 15:35:16,269 - Processing - WARNING - printing schema
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - print schema completed
2024-04-14 15:35:16,270 - Processing - INFO - print schema completed
2024-04-14 15:35:16,270 - Processing - WARNING - printing schema
2024-04-14 15:35:16,270 - Processing - WARNING - printing schema
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:35:16,270 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:35:16,271 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:35:16,271 - Processing - INFO - print schema completed
2024-04-14 15:35:16,271 - Processing - INFO - print schema completed
2024-04-14 15:35:16,271 - root - INFO - Application done
2024-04-14 15:55:12,886 - root - INFO - I am in the main method
2024-04-14 15:55:12,886 - root - INFO - Calling spark object
2024-04-14 15:55:12,886 - Create_spark - INFO - Creating spark object
2024-04-14 15:55:12,886 - Create_spark - INFO - Creating spark object
2024-04-14 15:55:12,886 - Create_spark - INFO - master is local
2024-04-14 15:55:12,886 - Create_spark - INFO - master is local
2024-04-14 15:55:19,851 - Create_spark - INFO - Spark object created
2024-04-14 15:55:19,851 - Create_spark - INFO - Spark object created
2024-04-14 15:55:19,851 - root - INFO - Validating spark object
2024-04-14 15:55:19,851 - Validate - WARNING - Started the spark object validation
2024-04-14 15:55:19,851 - Validate - WARNING - Started the spark object validation
2024-04-14 15:55:20,517 - Validate - WARNING - Validation completed
2024-04-14 15:55:20,517 - Validate - WARNING - Validation completed
2024-04-14 15:55:20,518 - root - INFO - reading file of format parquet from olap
2024-04-14 15:55:20,518 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:55:20,518 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:55:21,230 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:55:21,230 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:55:21,240 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:55:22,227 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:55:22,227 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:55:22,227 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:55:22,423 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:55:22,423 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:55:22,423 - root - INFO - reading file of format csv from oltp
2024-04-14 15:55:22,423 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:55:22,423 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:55:24,821 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:55:24,821 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:55:24,822 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:55:24,916 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:55:24,916 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:55:24,916 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:55:25,259 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:55:25,259 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:55:25,259 - root - INFO - implementing data_processing
2024-04-14 15:55:25,259 - Processing - WARNING - data clean method started
2024-04-14 15:55:25,259 - Processing - WARNING - data clean method started
2024-04-14 15:55:34,683 - Processing - WARNING - data cleaning completed
2024-04-14 15:55:34,683 - Processing - WARNING - data cleaning completed
2024-04-14 15:55:34,894 - root - INFO - checking schema
2024-04-14 15:55:34,894 - Processing - WARNING - printing schema
2024-04-14 15:55:34,894 - Processing - WARNING - printing schema
2024-04-14 15:55:34,895 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:55:34,895 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:55:34,896 - Processing - INFO - print schema completed
2024-04-14 15:55:34,896 - Processing - INFO - print schema completed
2024-04-14 15:55:34,896 - Processing - WARNING - printing schema
2024-04-14 15:55:34,896 - Processing - WARNING - printing schema
2024-04-14 15:55:34,897 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:55:34,897 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:55:34,898 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:55:34,899 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:55:34,900 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:55:34,900 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:55:34,900 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:55:34,900 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:55:34,900 - Processing - INFO - print schema completed
2024-04-14 15:55:34,900 - Processing - INFO - print schema completed
2024-04-14 15:55:34,901 - root - INFO - Application done
2024-04-14 15:56:58,038 - root - INFO - I am in the main method
2024-04-14 15:56:58,039 - root - INFO - Calling spark object
2024-04-14 15:56:58,039 - Create_spark - INFO - Creating spark object
2024-04-14 15:56:58,039 - Create_spark - INFO - Creating spark object
2024-04-14 15:56:58,039 - Create_spark - INFO - master is local
2024-04-14 15:56:58,039 - Create_spark - INFO - master is local
2024-04-14 15:57:04,870 - Create_spark - INFO - Spark object created
2024-04-14 15:57:04,870 - Create_spark - INFO - Spark object created
2024-04-14 15:57:04,870 - root - INFO - Validating spark object
2024-04-14 15:57:04,870 - Validate - WARNING - Started the spark object validation
2024-04-14 15:57:04,870 - Validate - WARNING - Started the spark object validation
2024-04-14 15:57:05,493 - Validate - WARNING - Validation completed
2024-04-14 15:57:05,493 - Validate - WARNING - Validation completed
2024-04-14 15:57:05,494 - root - INFO - reading file of format parquet from olap
2024-04-14 15:57:05,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:57:05,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 15:57:06,107 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:57:06,107 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 15:57:06,117 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:57:07,071 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 15:57:07,071 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:57:07,071 - Ingest - WARNING - counting number of records for df_city
2024-04-14 15:57:07,233 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:57:07,233 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 15:57:07,233 - root - INFO - reading file of format csv from oltp
2024-04-14 15:57:07,233 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:57:07,233 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 15:57:09,524 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:57:09,524 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 15:57:09,525 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:57:09,623 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 15:57:09,623 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:57:09,623 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 15:57:10,013 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:57:10,013 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 15:57:10,013 - root - INFO - implementing data_processing
2024-04-14 15:57:10,013 - Processing - WARNING - data clean method started
2024-04-14 15:57:10,013 - Processing - WARNING - data clean method started
2024-04-14 15:57:19,232 - Processing - WARNING - data cleaning completed
2024-04-14 15:57:19,232 - Processing - WARNING - data cleaning completed
2024-04-14 15:57:19,368 - root - INFO - checking schema
2024-04-14 15:57:19,368 - Processing - WARNING - printing schema
2024-04-14 15:57:19,368 - Processing - WARNING - printing schema
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 15:57:19,369 - Processing - INFO - print schema completed
2024-04-14 15:57:19,369 - Processing - INFO - print schema completed
2024-04-14 15:57:19,369 - Processing - WARNING - printing schema
2024-04-14 15:57:19,369 - Processing - WARNING - printing schema
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:57:19,370 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 15:57:19,370 - Processing - INFO - print schema completed
2024-04-14 15:57:19,370 - Processing - INFO - print schema completed
2024-04-14 15:57:19,370 - root - INFO - Application done
2024-04-14 17:31:07,451 - root - INFO - I am in the main method
2024-04-14 17:31:07,452 - root - INFO - Calling spark object
2024-04-14 17:31:07,452 - Create_spark - INFO - Creating spark object
2024-04-14 17:31:07,452 - Create_spark - INFO - Creating spark object
2024-04-14 17:31:07,452 - Create_spark - INFO - master is local
2024-04-14 17:31:07,452 - Create_spark - INFO - master is local
2024-04-14 17:31:14,341 - Create_spark - INFO - Spark object created
2024-04-14 17:31:14,341 - Create_spark - INFO - Spark object created
2024-04-14 17:31:14,341 - root - INFO - Validating spark object
2024-04-14 17:31:14,341 - Validate - WARNING - Started the spark object validation
2024-04-14 17:31:14,341 - Validate - WARNING - Started the spark object validation
2024-04-14 17:31:14,985 - Validate - WARNING - Validation completed
2024-04-14 17:31:14,985 - Validate - WARNING - Validation completed
2024-04-14 17:31:14,985 - root - INFO - reading file of format parquet from olap
2024-04-14 17:31:14,985 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:31:14,985 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:31:15,669 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:31:15,669 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:31:15,680 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:31:16,929 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:31:16,929 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:31:16,929 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:31:17,108 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:31:17,108 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:31:17,108 - root - INFO - reading file of format csv from oltp
2024-04-14 17:31:17,108 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:31:17,108 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:31:19,491 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:31:19,491 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:31:19,492 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:31:19,591 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:31:19,591 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:31:19,591 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:31:19,992 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:31:19,992 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:31:19,992 - root - INFO - implementing data_processing
2024-04-14 17:31:19,993 - Processing - WARNING - data clean method started
2024-04-14 17:31:19,993 - Processing - WARNING - data clean method started
2024-04-14 17:31:30,730 - Processing - WARNING - data cleaning completed
2024-04-14 17:31:30,730 - Processing - WARNING - data cleaning completed
2024-04-14 17:31:30,847 - root - INFO - checking schema
2024-04-14 17:31:30,847 - Processing - WARNING - printing schema
2024-04-14 17:31:30,847 - Processing - WARNING - printing schema
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - print schema completed
2024-04-14 17:31:30,848 - Processing - INFO - print schema completed
2024-04-14 17:31:30,848 - Processing - WARNING - printing schema
2024-04-14 17:31:30,848 - Processing - WARNING - printing schema
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:31:30,848 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:31:30,849 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:31:30,849 - Processing - INFO - print schema completed
2024-04-14 17:31:30,849 - Processing - INFO - print schema completed
2024-04-14 17:31:30,849 - root - INFO - creating view
2024-04-14 17:31:30,849 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:31:30,849 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:31:30,865 - Transformation - WARNING - views created successfully
2024-04-14 17:31:30,865 - Transformation - WARNING - views created successfully
2024-04-14 17:31:30,865 - root - INFO - Application done
2024-04-14 17:38:20,753 - root - INFO - I am in the main method
2024-04-14 17:38:20,753 - root - INFO - Calling spark object
2024-04-14 17:38:20,753 - Create_spark - INFO - Creating spark object
2024-04-14 17:38:20,753 - Create_spark - INFO - Creating spark object
2024-04-14 17:38:20,753 - Create_spark - INFO - master is local
2024-04-14 17:38:20,753 - Create_spark - INFO - master is local
2024-04-14 17:38:27,729 - Create_spark - INFO - Spark object created
2024-04-14 17:38:27,729 - Create_spark - INFO - Spark object created
2024-04-14 17:38:27,730 - root - INFO - Validating spark object
2024-04-14 17:38:27,730 - Validate - WARNING - Started the spark object validation
2024-04-14 17:38:27,730 - Validate - WARNING - Started the spark object validation
2024-04-14 17:38:28,363 - Validate - WARNING - Validation completed
2024-04-14 17:38:28,363 - Validate - WARNING - Validation completed
2024-04-14 17:38:28,363 - root - INFO - reading file of format parquet from olap
2024-04-14 17:38:28,363 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:38:28,363 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:38:29,011 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:38:29,011 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:38:29,022 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:38:30,292 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:38:30,292 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:38:30,292 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:38:30,461 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:38:30,461 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:38:30,461 - root - INFO - reading file of format csv from oltp
2024-04-14 17:38:30,461 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:38:30,461 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:38:32,855 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:38:32,855 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:38:32,857 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:38:32,949 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:38:32,949 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:38:32,949 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:38:33,317 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:38:33,317 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:38:33,317 - root - INFO - implementing data_processing
2024-04-14 17:38:33,317 - Processing - WARNING - data clean method started
2024-04-14 17:38:33,317 - Processing - WARNING - data clean method started
2024-04-14 17:38:43,892 - Processing - WARNING - data cleaning completed
2024-04-14 17:38:43,892 - Processing - WARNING - data cleaning completed
2024-04-14 17:38:44,031 - root - INFO - checking schema
2024-04-14 17:38:44,031 - Processing - WARNING - printing schema
2024-04-14 17:38:44,031 - Processing - WARNING - printing schema
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - print schema completed
2024-04-14 17:38:44,032 - Processing - INFO - print schema completed
2024-04-14 17:38:44,032 - Processing - WARNING - printing schema
2024-04-14 17:38:44,032 - Processing - WARNING - printing schema
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:38:44,032 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:38:44,032 - Processing - INFO - print schema completed
2024-04-14 17:38:44,032 - Processing - INFO - print schema completed
2024-04-14 17:38:44,032 - root - INFO - creating view
2024-04-14 17:38:44,033 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:38:44,033 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:38:44,049 - Transformation - WARNING - views created successfully
2024-04-14 17:38:44,049 - Transformation - WARNING - views created successfully
2024-04-14 17:38:44,050 - root - INFO - Calculating total zips count in city view
2024-04-14 17:38:44,116 - Transformation - ERROR - an error occured while calculating zips count
2024-04-14 17:38:44,116 - Transformation - ERROR - an error occured while calculating zips count
2024-04-14 17:38:44,116 - root - INFO - Application done
2024-04-14 17:39:22,115 - root - INFO - I am in the main method
2024-04-14 17:39:22,115 - root - INFO - Calling spark object
2024-04-14 17:39:22,115 - Create_spark - INFO - Creating spark object
2024-04-14 17:39:22,115 - Create_spark - INFO - Creating spark object
2024-04-14 17:39:22,115 - Create_spark - INFO - master is local
2024-04-14 17:39:22,115 - Create_spark - INFO - master is local
2024-04-14 17:39:28,974 - Create_spark - INFO - Spark object created
2024-04-14 17:39:28,974 - Create_spark - INFO - Spark object created
2024-04-14 17:39:28,975 - root - INFO - Validating spark object
2024-04-14 17:39:28,975 - Validate - WARNING - Started the spark object validation
2024-04-14 17:39:28,975 - Validate - WARNING - Started the spark object validation
2024-04-14 17:39:29,597 - Validate - WARNING - Validation completed
2024-04-14 17:39:29,597 - Validate - WARNING - Validation completed
2024-04-14 17:39:29,597 - root - INFO - reading file of format parquet from olap
2024-04-14 17:39:29,597 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:39:29,597 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:39:30,287 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:39:30,287 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:39:30,298 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:39:31,258 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:39:31,258 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:39:31,258 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:39:31,439 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:39:31,439 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:39:31,440 - root - INFO - reading file of format csv from oltp
2024-04-14 17:39:31,440 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:39:31,440 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:39:33,889 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:39:33,889 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:39:33,891 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:39:33,995 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:39:33,995 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:39:33,995 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:39:34,344 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:39:34,344 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:39:34,344 - root - INFO - implementing data_processing
2024-04-14 17:39:34,344 - Processing - WARNING - data clean method started
2024-04-14 17:39:34,344 - Processing - WARNING - data clean method started
2024-04-14 17:39:45,127 - Processing - WARNING - data cleaning completed
2024-04-14 17:39:45,127 - Processing - WARNING - data cleaning completed
2024-04-14 17:39:45,249 - root - INFO - checking schema
2024-04-14 17:39:45,249 - Processing - WARNING - printing schema
2024-04-14 17:39:45,249 - Processing - WARNING - printing schema
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - print schema completed
2024-04-14 17:39:45,250 - Processing - INFO - print schema completed
2024-04-14 17:39:45,250 - Processing - WARNING - printing schema
2024-04-14 17:39:45,250 - Processing - WARNING - printing schema
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:39:45,250 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:39:45,251 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:39:45,251 - Processing - INFO - print schema completed
2024-04-14 17:39:45,251 - Processing - INFO - print schema completed
2024-04-14 17:39:45,251 - root - INFO - creating view
2024-04-14 17:39:45,251 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:39:45,251 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:39:45,267 - Transformation - WARNING - views created successfully
2024-04-14 17:39:45,267 - Transformation - WARNING - views created successfully
2024-04-14 17:39:45,267 - root - INFO - Calculating total zips count in city view
2024-04-14 17:39:45,358 - Transformation - ERROR - an error occured while calculating zips count
2024-04-14 17:39:45,358 - Transformation - ERROR - an error occured while calculating zips count
2024-04-14 17:39:45,358 - root - INFO - Application done
2024-04-14 17:39:55,100 - root - INFO - I am in the main method
2024-04-14 17:39:55,100 - root - INFO - Calling spark object
2024-04-14 17:39:55,100 - Create_spark - INFO - Creating spark object
2024-04-14 17:39:55,100 - Create_spark - INFO - Creating spark object
2024-04-14 17:39:55,100 - Create_spark - INFO - master is local
2024-04-14 17:39:55,100 - Create_spark - INFO - master is local
2024-04-14 17:40:01,679 - Create_spark - INFO - Spark object created
2024-04-14 17:40:01,679 - Create_spark - INFO - Spark object created
2024-04-14 17:40:01,679 - root - INFO - Validating spark object
2024-04-14 17:40:01,679 - Validate - WARNING - Started the spark object validation
2024-04-14 17:40:01,679 - Validate - WARNING - Started the spark object validation
2024-04-14 17:40:02,241 - Validate - WARNING - Validation completed
2024-04-14 17:40:02,241 - Validate - WARNING - Validation completed
2024-04-14 17:40:02,242 - root - INFO - reading file of format parquet from olap
2024-04-14 17:40:02,242 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:40:02,242 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:40:02,815 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:40:02,815 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:40:02,825 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:40:03,748 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:40:03,748 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:40:03,748 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:40:03,906 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:40:03,906 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:40:03,906 - root - INFO - reading file of format csv from oltp
2024-04-14 17:40:03,907 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:40:03,907 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:40:06,313 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:40:06,313 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:40:06,314 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:40:06,402 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:40:06,402 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:40:06,402 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:40:06,735 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:40:06,735 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:40:06,736 - root - INFO - implementing data_processing
2024-04-14 17:40:06,736 - Processing - WARNING - data clean method started
2024-04-14 17:40:06,736 - Processing - WARNING - data clean method started
2024-04-14 17:40:17,427 - Processing - WARNING - data cleaning completed
2024-04-14 17:40:17,427 - Processing - WARNING - data cleaning completed
2024-04-14 17:40:17,526 - root - INFO - checking schema
2024-04-14 17:40:17,526 - Processing - WARNING - printing schema
2024-04-14 17:40:17,526 - Processing - WARNING - printing schema
2024-04-14 17:40:17,526 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:40:17,526 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - print schema completed
2024-04-14 17:40:17,527 - Processing - INFO - print schema completed
2024-04-14 17:40:17,527 - Processing - WARNING - printing schema
2024-04-14 17:40:17,527 - Processing - WARNING - printing schema
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:40:17,527 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:40:17,527 - Processing - INFO - print schema completed
2024-04-14 17:40:17,527 - Processing - INFO - print schema completed
2024-04-14 17:40:17,527 - root - INFO - creating view
2024-04-14 17:40:17,527 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:40:17,527 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:40:17,544 - Transformation - WARNING - views created successfully
2024-04-14 17:40:17,544 - Transformation - WARNING - views created successfully
2024-04-14 17:40:17,544 - root - INFO - Calculating total zips count in city view
2024-04-14 17:40:17,601 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:40:17,601 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:40:17,601 - root - INFO - Application done
2024-04-14 17:48:36,363 - root - INFO - I am in the main method
2024-04-14 17:48:36,363 - root - INFO - Calling spark object
2024-04-14 17:48:36,364 - Create_spark - INFO - Creating spark object
2024-04-14 17:48:36,364 - Create_spark - INFO - Creating spark object
2024-04-14 17:48:36,364 - Create_spark - INFO - master is local
2024-04-14 17:48:36,364 - Create_spark - INFO - master is local
2024-04-14 17:48:43,236 - Create_spark - INFO - Spark object created
2024-04-14 17:48:43,236 - Create_spark - INFO - Spark object created
2024-04-14 17:48:43,236 - root - INFO - Validating spark object
2024-04-14 17:48:43,236 - Validate - WARNING - Started the spark object validation
2024-04-14 17:48:43,236 - Validate - WARNING - Started the spark object validation
2024-04-14 17:48:43,890 - Validate - WARNING - Validation completed
2024-04-14 17:48:43,890 - Validate - WARNING - Validation completed
2024-04-14 17:48:43,891 - root - INFO - reading file of format parquet from olap
2024-04-14 17:48:43,891 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:48:43,891 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:48:47,527 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:48:47,527 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:48:47,537 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:48:48,630 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:48:48,630 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:48:48,630 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:48:48,807 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:48:48,807 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:48:48,808 - root - INFO - reading file of format csv from oltp
2024-04-14 17:48:48,808 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:48:48,808 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:48:51,242 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:48:51,242 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:48:51,245 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:48:51,351 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:48:51,351 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:48:51,351 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:48:51,707 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:48:51,707 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:48:51,708 - root - INFO - implementing data_processing
2024-04-14 17:48:51,708 - Processing - WARNING - data clean method started
2024-04-14 17:48:51,708 - Processing - WARNING - data clean method started
2024-04-14 17:49:02,273 - Processing - WARNING - data cleaning completed
2024-04-14 17:49:02,273 - Processing - WARNING - data cleaning completed
2024-04-14 17:49:02,408 - root - INFO - checking schema
2024-04-14 17:49:02,408 - Processing - WARNING - printing schema
2024-04-14 17:49:02,408 - Processing - WARNING - printing schema
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - print schema completed
2024-04-14 17:49:02,409 - Processing - INFO - print schema completed
2024-04-14 17:49:02,409 - Processing - WARNING - printing schema
2024-04-14 17:49:02,409 - Processing - WARNING - printing schema
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:49:02,409 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:49:02,410 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:49:02,410 - Processing - INFO - print schema completed
2024-04-14 17:49:02,410 - Processing - INFO - print schema completed
2024-04-14 17:49:02,410 - root - INFO - creating view
2024-04-14 17:49:02,410 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:49:02,410 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:49:02,426 - Transformation - WARNING - views created successfully
2024-04-14 17:49:02,426 - Transformation - WARNING - views created successfully
2024-04-14 17:49:02,427 - root - INFO - Calculating total zips count in city view
2024-04-14 17:49:02,484 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:49:02,484 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:49:02,484 - root - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 17:49:05,290 - Transformation - WARNING - presc_report calculation successfully
2024-04-14 17:49:05,290 - Transformation - WARNING - presc_report calculation successfully
2024-04-14 17:49:05,290 - root - INFO - Application done
2024-04-14 17:49:44,135 - root - INFO - I am in the main method
2024-04-14 17:49:44,135 - root - INFO - Calling spark object
2024-04-14 17:49:44,135 - Create_spark - INFO - Creating spark object
2024-04-14 17:49:44,135 - Create_spark - INFO - Creating spark object
2024-04-14 17:49:44,135 - Create_spark - INFO - master is local
2024-04-14 17:49:44,135 - Create_spark - INFO - master is local
2024-04-14 17:49:50,997 - Create_spark - INFO - Spark object created
2024-04-14 17:49:50,997 - Create_spark - INFO - Spark object created
2024-04-14 17:49:50,998 - root - INFO - Validating spark object
2024-04-14 17:49:50,998 - Validate - WARNING - Started the spark object validation
2024-04-14 17:49:50,998 - Validate - WARNING - Started the spark object validation
2024-04-14 17:49:51,650 - Validate - WARNING - Validation completed
2024-04-14 17:49:51,650 - Validate - WARNING - Validation completed
2024-04-14 17:49:51,651 - root - INFO - reading file of format parquet from olap
2024-04-14 17:49:51,651 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:49:51,651 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:49:52,280 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:49:52,280 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:49:52,292 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:49:53,259 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:49:53,259 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:49:53,259 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:49:53,428 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:49:53,428 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:49:53,428 - root - INFO - reading file of format csv from oltp
2024-04-14 17:49:53,428 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:49:53,428 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:49:55,809 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:49:55,809 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:49:55,810 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:49:55,911 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:49:55,911 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:49:55,911 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:49:56,248 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:49:56,248 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:49:56,248 - root - INFO - implementing data_processing
2024-04-14 17:49:56,248 - Processing - WARNING - data clean method started
2024-04-14 17:49:56,248 - Processing - WARNING - data clean method started
2024-04-14 17:50:07,115 - Processing - WARNING - data cleaning completed
2024-04-14 17:50:07,115 - Processing - WARNING - data cleaning completed
2024-04-14 17:50:07,241 - root - INFO - checking schema
2024-04-14 17:50:07,242 - Processing - WARNING - printing schema
2024-04-14 17:50:07,242 - Processing - WARNING - printing schema
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:50:07,245 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:50:07,246 - Processing - INFO - print schema completed
2024-04-14 17:50:07,246 - Processing - INFO - print schema completed
2024-04-14 17:50:07,246 - Processing - WARNING - printing schema
2024-04-14 17:50:07,246 - Processing - WARNING - printing schema
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:50:07,251 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:50:07,251 - Processing - INFO - print schema completed
2024-04-14 17:50:07,251 - Processing - INFO - print schema completed
2024-04-14 17:50:07,252 - root - INFO - creating view
2024-04-14 17:50:07,252 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:50:07,252 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:50:07,285 - Transformation - WARNING - views created successfully
2024-04-14 17:50:07,285 - Transformation - WARNING - views created successfully
2024-04-14 17:50:07,285 - root - INFO - Calculating total zips count in city view
2024-04-14 17:50:07,362 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:50:07,362 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:50:07,362 - root - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 17:50:10,327 - Transformation - WARNING - presc_report calculation successfully
2024-04-14 17:50:10,327 - Transformation - WARNING - presc_report calculation successfully
2024-04-14 17:50:10,327 - root - INFO - Application done
2024-04-14 17:58:42,445 - root - INFO - I am in the main method
2024-04-14 17:58:42,446 - root - INFO - Calling spark object
2024-04-14 17:58:42,446 - Create_spark - INFO - Creating spark object
2024-04-14 17:58:42,446 - Create_spark - INFO - Creating spark object
2024-04-14 17:58:42,446 - Create_spark - INFO - master is local
2024-04-14 17:58:42,446 - Create_spark - INFO - master is local
2024-04-14 17:58:49,299 - Create_spark - INFO - Spark object created
2024-04-14 17:58:49,299 - Create_spark - INFO - Spark object created
2024-04-14 17:58:49,299 - root - INFO - Validating spark object
2024-04-14 17:58:49,299 - Validate - WARNING - Started the spark object validation
2024-04-14 17:58:49,299 - Validate - WARNING - Started the spark object validation
2024-04-14 17:58:49,923 - Validate - WARNING - Validation completed
2024-04-14 17:58:49,923 - Validate - WARNING - Validation completed
2024-04-14 17:58:49,924 - root - INFO - reading file of format parquet from olap
2024-04-14 17:58:49,924 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:58:49,924 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:58:50,507 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:58:50,507 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:58:50,517 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:58:51,502 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:58:51,502 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:58:51,502 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:58:51,688 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:58:51,688 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:58:51,689 - root - INFO - reading file of format csv from oltp
2024-04-14 17:58:51,689 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:58:51,689 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:58:54,090 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:58:54,090 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:58:54,092 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:58:54,187 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:58:54,187 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:58:54,187 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:58:54,555 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:58:54,555 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:58:54,556 - root - INFO - implementing data_processing
2024-04-14 17:58:54,556 - Processing - WARNING - data clean method started
2024-04-14 17:58:54,556 - Processing - WARNING - data clean method started
2024-04-14 17:59:05,139 - Processing - WARNING - data cleaning completed
2024-04-14 17:59:05,139 - Processing - WARNING - data cleaning completed
2024-04-14 17:59:05,251 - root - INFO - checking schema
2024-04-14 17:59:05,251 - Processing - WARNING - printing schema
2024-04-14 17:59:05,251 - Processing - WARNING - printing schema
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:59:05,252 - Processing - INFO - print schema completed
2024-04-14 17:59:05,252 - Processing - INFO - print schema completed
2024-04-14 17:59:05,252 - Processing - WARNING - printing schema
2024-04-14 17:59:05,252 - Processing - WARNING - printing schema
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:59:05,253 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:59:05,253 - Processing - INFO - print schema completed
2024-04-14 17:59:05,253 - Processing - INFO - print schema completed
2024-04-14 17:59:05,254 - root - INFO - creating view
2024-04-14 17:59:05,254 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:59:05,254 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:59:05,277 - Transformation - WARNING - views created successfully
2024-04-14 17:59:05,277 - Transformation - WARNING - views created successfully
2024-04-14 17:59:05,277 - root - INFO - Calculating Insights
2024-04-14 17:59:05,277 - root - INFO - Calculating total zips count in city view
2024-04-14 17:59:05,332 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:59:05,332 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:59:05,332 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 17:59:05,332 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 17:59:08,228 - Transformation - WARNING - presc_report calculation successful
2024-04-14 17:59:08,228 - Transformation - WARNING - presc_report calculation successful
2024-04-14 17:59:08,228 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 17:59:08,228 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 17:59:11,550 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 17:59:11,550 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 17:59:11,550 - root - INFO - Application done
2024-04-14 17:59:35,527 - root - INFO - I am in the main method
2024-04-14 17:59:35,527 - root - INFO - Calling spark object
2024-04-14 17:59:35,527 - Create_spark - INFO - Creating spark object
2024-04-14 17:59:35,527 - Create_spark - INFO - Creating spark object
2024-04-14 17:59:35,527 - Create_spark - INFO - master is local
2024-04-14 17:59:35,527 - Create_spark - INFO - master is local
2024-04-14 17:59:41,984 - Create_spark - INFO - Spark object created
2024-04-14 17:59:41,984 - Create_spark - INFO - Spark object created
2024-04-14 17:59:41,984 - root - INFO - Validating spark object
2024-04-14 17:59:41,984 - Validate - WARNING - Started the spark object validation
2024-04-14 17:59:41,984 - Validate - WARNING - Started the spark object validation
2024-04-14 17:59:42,539 - Validate - WARNING - Validation completed
2024-04-14 17:59:42,539 - Validate - WARNING - Validation completed
2024-04-14 17:59:42,539 - root - INFO - reading file of format parquet from olap
2024-04-14 17:59:42,539 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:59:42,539 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 17:59:43,158 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:59:43,158 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 17:59:43,168 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:59:44,101 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 17:59:44,101 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:59:44,101 - Ingest - WARNING - counting number of records for df_city
2024-04-14 17:59:44,287 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:59:44,287 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 17:59:44,288 - root - INFO - reading file of format csv from oltp
2024-04-14 17:59:44,288 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:59:44,288 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 17:59:46,718 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:59:46,718 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 17:59:46,719 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:59:46,829 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 17:59:46,829 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:59:46,829 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 17:59:47,175 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:59:47,175 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 17:59:47,175 - root - INFO - implementing data_processing
2024-04-14 17:59:47,175 - Processing - WARNING - data clean method started
2024-04-14 17:59:47,175 - Processing - WARNING - data clean method started
2024-04-14 17:59:57,692 - Processing - WARNING - data cleaning completed
2024-04-14 17:59:57,692 - Processing - WARNING - data cleaning completed
2024-04-14 17:59:57,813 - root - INFO - checking schema
2024-04-14 17:59:57,813 - Processing - WARNING - printing schema
2024-04-14 17:59:57,813 - Processing - WARNING - printing schema
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 17:59:57,813 - Processing - INFO - print schema completed
2024-04-14 17:59:57,813 - Processing - INFO - print schema completed
2024-04-14 17:59:57,813 - Processing - WARNING - printing schema
2024-04-14 17:59:57,813 - Processing - WARNING - printing schema
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:59:57,814 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 17:59:57,814 - Processing - INFO - print schema completed
2024-04-14 17:59:57,814 - Processing - INFO - print schema completed
2024-04-14 17:59:57,814 - root - INFO - creating view
2024-04-14 17:59:57,814 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:59:57,814 - Transformation - WARNING - creating view from the dataframes
2024-04-14 17:59:57,836 - Transformation - WARNING - views created successfully
2024-04-14 17:59:57,836 - Transformation - WARNING - views created successfully
2024-04-14 17:59:57,836 - root - INFO - Calculating Insights
2024-04-14 17:59:57,836 - root - INFO - Calculating total zips count in city view
2024-04-14 17:59:57,907 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:59:57,907 - Transformation - WARNING - zips count calculated successfully
2024-04-14 17:59:57,907 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 17:59:57,907 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:00:00,635 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:00:00,635 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:00:00,635 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:00:00,635 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:00:00,696 - Transformation - ERROR - an error occured while calculating city with no prescribers
2024-04-14 18:00:00,696 - Transformation - ERROR - an error occured while calculating city with no prescribers
2024-04-14 18:00:00,697 - root - INFO - Application done
2024-04-14 18:00:48,641 - root - INFO - I am in the main method
2024-04-14 18:00:48,641 - root - INFO - Calling spark object
2024-04-14 18:00:48,641 - Create_spark - INFO - Creating spark object
2024-04-14 18:00:48,641 - Create_spark - INFO - Creating spark object
2024-04-14 18:00:48,641 - Create_spark - INFO - master is local
2024-04-14 18:00:48,641 - Create_spark - INFO - master is local
2024-04-14 18:00:55,367 - Create_spark - INFO - Spark object created
2024-04-14 18:00:55,367 - Create_spark - INFO - Spark object created
2024-04-14 18:00:55,367 - root - INFO - Validating spark object
2024-04-14 18:00:55,367 - Validate - WARNING - Started the spark object validation
2024-04-14 18:00:55,367 - Validate - WARNING - Started the spark object validation
2024-04-14 18:00:55,968 - Validate - WARNING - Validation completed
2024-04-14 18:00:55,968 - Validate - WARNING - Validation completed
2024-04-14 18:00:55,969 - root - INFO - reading file of format parquet from olap
2024-04-14 18:00:55,969 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:00:55,969 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:00:56,603 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:00:56,603 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:00:56,613 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:00:57,560 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:00:57,560 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:00:57,560 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:00:57,732 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:00:57,732 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:00:57,732 - root - INFO - reading file of format csv from oltp
2024-04-14 18:00:57,732 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:00:57,732 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:01:00,120 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:01:00,120 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:01:00,122 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:01:00,222 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:01:00,222 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:01:00,222 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:01:00,559 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:01:00,559 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:01:00,559 - root - INFO - implementing data_processing
2024-04-14 18:01:00,559 - Processing - WARNING - data clean method started
2024-04-14 18:01:00,559 - Processing - WARNING - data clean method started
2024-04-14 18:01:11,150 - Processing - WARNING - data cleaning completed
2024-04-14 18:01:11,150 - Processing - WARNING - data cleaning completed
2024-04-14 18:01:11,254 - root - INFO - checking schema
2024-04-14 18:01:11,255 - Processing - WARNING - printing schema
2024-04-14 18:01:11,255 - Processing - WARNING - printing schema
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:01:11,255 - Processing - INFO - print schema completed
2024-04-14 18:01:11,255 - Processing - INFO - print schema completed
2024-04-14 18:01:11,255 - Processing - WARNING - printing schema
2024-04-14 18:01:11,255 - Processing - WARNING - printing schema
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:01:11,256 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:01:11,256 - Processing - INFO - print schema completed
2024-04-14 18:01:11,256 - Processing - INFO - print schema completed
2024-04-14 18:01:11,256 - root - INFO - creating view
2024-04-14 18:01:11,256 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:01:11,256 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:01:11,272 - Transformation - WARNING - views created successfully
2024-04-14 18:01:11,272 - Transformation - WARNING - views created successfully
2024-04-14 18:01:11,272 - root - INFO - Calculating Insights
2024-04-14 18:01:11,272 - root - INFO - Calculating total zips count in city view
2024-04-14 18:01:11,328 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:01:11,328 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:01:11,328 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:01:11,328 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:01:14,051 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:01:14,051 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:01:14,051 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:01:14,051 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:01:14,118 - Transformation - ERROR - an error occured while calculating city with no prescribers
2024-04-14 18:01:14,118 - Transformation - ERROR - an error occured while calculating city with no prescribers
2024-04-14 18:01:14,118 - root - INFO - Application done
2024-04-14 18:02:27,251 - root - INFO - I am in the main method
2024-04-14 18:02:27,251 - root - INFO - Calling spark object
2024-04-14 18:02:27,251 - Create_spark - INFO - Creating spark object
2024-04-14 18:02:27,251 - Create_spark - INFO - Creating spark object
2024-04-14 18:02:27,251 - Create_spark - INFO - master is local
2024-04-14 18:02:27,251 - Create_spark - INFO - master is local
2024-04-14 18:02:33,706 - Create_spark - INFO - Spark object created
2024-04-14 18:02:33,706 - Create_spark - INFO - Spark object created
2024-04-14 18:02:33,706 - root - INFO - Validating spark object
2024-04-14 18:02:33,706 - Validate - WARNING - Started the spark object validation
2024-04-14 18:02:33,706 - Validate - WARNING - Started the spark object validation
2024-04-14 18:02:34,262 - Validate - WARNING - Validation completed
2024-04-14 18:02:34,262 - Validate - WARNING - Validation completed
2024-04-14 18:02:34,262 - root - INFO - reading file of format parquet from olap
2024-04-14 18:02:34,263 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:02:34,263 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:02:34,909 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:02:34,909 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:02:34,919 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:02:38,881 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:02:38,881 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:02:38,881 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:02:39,068 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:02:39,068 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:02:39,068 - root - INFO - reading file of format csv from oltp
2024-04-14 18:02:39,068 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:02:39,068 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:02:41,694 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:02:41,694 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:02:41,696 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:02:41,796 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:02:41,796 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:02:41,796 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:02:42,210 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:02:42,210 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:02:42,210 - root - INFO - implementing data_processing
2024-04-14 18:02:42,211 - Processing - WARNING - data clean method started
2024-04-14 18:02:42,211 - Processing - WARNING - data clean method started
2024-04-14 18:02:52,946 - Processing - WARNING - data cleaning completed
2024-04-14 18:02:52,946 - Processing - WARNING - data cleaning completed
2024-04-14 18:02:53,045 - root - INFO - checking schema
2024-04-14 18:02:53,045 - Processing - WARNING - printing schema
2024-04-14 18:02:53,045 - Processing - WARNING - printing schema
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - print schema completed
2024-04-14 18:02:53,046 - Processing - INFO - print schema completed
2024-04-14 18:02:53,046 - Processing - WARNING - printing schema
2024-04-14 18:02:53,046 - Processing - WARNING - printing schema
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:02:53,046 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:02:53,047 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:02:53,047 - Processing - INFO - print schema completed
2024-04-14 18:02:53,047 - Processing - INFO - print schema completed
2024-04-14 18:02:53,047 - root - INFO - creating view
2024-04-14 18:02:53,047 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:02:53,047 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:02:53,063 - Transformation - WARNING - views created successfully
2024-04-14 18:02:53,063 - Transformation - WARNING - views created successfully
2024-04-14 18:02:53,063 - root - INFO - Calculating Insights
2024-04-14 18:02:53,063 - root - INFO - Calculating total zips count in city view
2024-04-14 18:02:53,120 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:02:53,120 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:02:53,120 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:02:53,120 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:02:55,936 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:02:55,936 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:02:55,936 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:02:55,936 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:02:58,883 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 18:02:58,883 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 18:02:58,883 - root - INFO - Application done
2024-04-14 18:07:01,757 - root - INFO - I am in the main method
2024-04-14 18:07:01,758 - root - INFO - Calling spark object
2024-04-14 18:07:01,758 - Create_spark - INFO - Creating spark object
2024-04-14 18:07:01,758 - Create_spark - INFO - Creating spark object
2024-04-14 18:07:01,758 - Create_spark - INFO - master is local
2024-04-14 18:07:01,758 - Create_spark - INFO - master is local
2024-04-14 18:07:08,682 - Create_spark - INFO - Spark object created
2024-04-14 18:07:08,682 - Create_spark - INFO - Spark object created
2024-04-14 18:07:08,683 - root - INFO - Validating spark object
2024-04-14 18:07:08,683 - Validate - WARNING - Started the spark object validation
2024-04-14 18:07:08,683 - Validate - WARNING - Started the spark object validation
2024-04-14 18:07:09,308 - Validate - WARNING - Validation completed
2024-04-14 18:07:09,308 - Validate - WARNING - Validation completed
2024-04-14 18:07:09,308 - root - INFO - reading file of format parquet from olap
2024-04-14 18:07:09,308 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:07:09,308 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:07:09,936 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:07:09,936 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:07:09,948 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:07:10,890 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:07:10,890 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:07:10,890 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:07:11,054 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:07:11,054 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:07:11,055 - root - INFO - reading file of format csv from oltp
2024-04-14 18:07:11,055 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:07:11,055 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:07:13,339 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:07:13,339 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:07:13,340 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:07:13,437 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:07:13,437 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:07:13,437 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:07:13,787 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:07:13,787 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:07:13,787 - root - INFO - implementing data_processing
2024-04-14 18:07:13,787 - Processing - WARNING - data clean method started
2024-04-14 18:07:13,787 - Processing - WARNING - data clean method started
2024-04-14 18:07:24,742 - Processing - WARNING - data cleaning completed
2024-04-14 18:07:24,742 - Processing - WARNING - data cleaning completed
2024-04-14 18:07:24,854 - root - INFO - checking schema
2024-04-14 18:07:24,854 - Processing - WARNING - printing schema
2024-04-14 18:07:24,854 - Processing - WARNING - printing schema
2024-04-14 18:07:24,854 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:07:24,854 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - print schema completed
2024-04-14 18:07:24,855 - Processing - INFO - print schema completed
2024-04-14 18:07:24,855 - Processing - WARNING - printing schema
2024-04-14 18:07:24,855 - Processing - WARNING - printing schema
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:07:24,855 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:07:24,855 - Processing - INFO - print schema completed
2024-04-14 18:07:24,855 - Processing - INFO - print schema completed
2024-04-14 18:07:24,855 - root - INFO - creating view
2024-04-14 18:07:24,855 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:07:24,855 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:07:24,871 - Transformation - WARNING - views created successfully
2024-04-14 18:07:24,871 - Transformation - WARNING - views created successfully
2024-04-14 18:07:24,871 - root - INFO - Calculating Insights
2024-04-14 18:07:24,871 - root - INFO - Calculating total zips count in city view
2024-04-14 18:07:24,925 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:07:24,925 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:07:24,925 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:07:24,925 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:07:27,676 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:07:27,676 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:07:27,676 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:07:27,676 - Transformation - INFO - Calculating city with no prescribers
2024-04-14 18:07:30,751 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 18:07:30,751 - Transformation - WARNING - city with no prescribers calculation successful
2024-04-14 18:07:30,752 - root - INFO - Application done
2024-04-14 18:09:04,053 - root - INFO - I am in the main method
2024-04-14 18:09:04,053 - root - INFO - Calling spark object
2024-04-14 18:09:04,053 - Create_spark - INFO - Creating spark object
2024-04-14 18:09:04,053 - Create_spark - INFO - Creating spark object
2024-04-14 18:09:04,053 - Create_spark - INFO - master is local
2024-04-14 18:09:04,053 - Create_spark - INFO - master is local
2024-04-14 18:09:10,950 - Create_spark - INFO - Spark object created
2024-04-14 18:09:10,950 - Create_spark - INFO - Spark object created
2024-04-14 18:09:10,950 - root - INFO - Validating spark object
2024-04-14 18:09:10,950 - Validate - WARNING - Started the spark object validation
2024-04-14 18:09:10,950 - Validate - WARNING - Started the spark object validation
2024-04-14 18:09:11,602 - Validate - WARNING - Validation completed
2024-04-14 18:09:11,602 - Validate - WARNING - Validation completed
2024-04-14 18:09:11,602 - root - INFO - reading file of format parquet from olap
2024-04-14 18:09:11,602 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:09:11,602 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 18:09:12,238 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:09:12,238 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 18:09:12,248 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:09:13,545 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 18:09:13,545 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:09:13,545 - Ingest - WARNING - counting number of records for df_city
2024-04-14 18:09:13,722 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:09:13,722 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 18:09:13,722 - root - INFO - reading file of format csv from oltp
2024-04-14 18:09:13,722 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:09:13,722 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 18:09:16,041 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:09:16,041 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 18:09:16,042 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:09:16,138 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 18:09:16,138 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:09:16,138 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 18:09:16,502 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:09:16,502 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 18:09:16,502 - root - INFO - implementing data_processing
2024-04-14 18:09:16,502 - Processing - WARNING - data clean method started
2024-04-14 18:09:16,502 - Processing - WARNING - data clean method started
2024-04-14 18:09:27,061 - Processing - WARNING - data cleaning completed
2024-04-14 18:09:27,061 - Processing - WARNING - data cleaning completed
2024-04-14 18:09:27,166 - root - INFO - checking schema
2024-04-14 18:09:27,167 - Processing - WARNING - printing schema
2024-04-14 18:09:27,167 - Processing - WARNING - printing schema
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 18:09:27,167 - Processing - INFO - print schema completed
2024-04-14 18:09:27,167 - Processing - INFO - print schema completed
2024-04-14 18:09:27,167 - Processing - WARNING - printing schema
2024-04-14 18:09:27,167 - Processing - WARNING - printing schema
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:09:27,168 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 18:09:27,168 - Processing - INFO - print schema completed
2024-04-14 18:09:27,168 - Processing - INFO - print schema completed
2024-04-14 18:09:27,168 - root - INFO - creating view
2024-04-14 18:09:27,168 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:09:27,168 - Transformation - WARNING - creating view from the dataframes
2024-04-14 18:09:27,184 - Transformation - WARNING - views created successfully
2024-04-14 18:09:27,184 - Transformation - WARNING - views created successfully
2024-04-14 18:09:27,184 - root - INFO - Calculating Insights
2024-04-14 18:09:27,184 - root - INFO - Calculating total zips count in city view
2024-04-14 18:09:27,240 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:09:27,240 - Transformation - WARNING - zips count calculated successfully
2024-04-14 18:09:27,240 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:09:27,240 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 18:09:29,972 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:09:29,972 - Transformation - WARNING - presc_report calculation successful
2024-04-14 18:09:29,972 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 18:09:29,972 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 18:09:32,769 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 18:09:32,769 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 18:09:32,769 - root - INFO - Application done
2024-04-14 21:18:38,640 - root - INFO - I am in the main method
2024-04-14 21:18:38,641 - root - INFO - Calling spark object
2024-04-14 21:18:38,641 - Create_spark - INFO - Creating spark object
2024-04-14 21:18:38,641 - Create_spark - INFO - Creating spark object
2024-04-14 21:18:38,641 - Create_spark - INFO - master is local
2024-04-14 21:18:38,641 - Create_spark - INFO - master is local
2024-04-14 21:18:45,582 - Create_spark - INFO - Spark object created
2024-04-14 21:18:45,582 - Create_spark - INFO - Spark object created
2024-04-14 21:18:45,582 - root - INFO - Validating spark object
2024-04-14 21:18:45,582 - Validate - WARNING - Started the spark object validation
2024-04-14 21:18:45,582 - Validate - WARNING - Started the spark object validation
2024-04-14 21:18:46,218 - Validate - WARNING - Validation completed
2024-04-14 21:18:46,218 - Validate - WARNING - Validation completed
2024-04-14 21:18:46,219 - root - INFO - reading file of format parquet from olap
2024-04-14 21:18:46,219 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:18:46,219 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:18:46,979 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:18:46,979 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:18:46,990 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:18:48,287 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:18:48,287 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:18:48,287 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:18:48,457 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:18:48,457 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:18:48,457 - root - INFO - reading file of format csv from oltp
2024-04-14 21:18:48,457 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:18:48,457 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:18:50,848 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:18:50,848 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:18:50,850 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:18:50,955 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:18:50,956 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:18:50,956 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:18:51,297 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:18:51,297 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:18:51,297 - root - INFO - implementing data_processing
2024-04-14 21:18:51,297 - Processing - WARNING - data clean method started
2024-04-14 21:18:51,297 - Processing - WARNING - data clean method started
2024-04-14 21:19:02,005 - Processing - WARNING - data cleaning completed
2024-04-14 21:19:02,005 - Processing - WARNING - data cleaning completed
2024-04-14 21:19:02,105 - root - INFO - checking schema
2024-04-14 21:19:02,105 - Processing - WARNING - printing schema
2024-04-14 21:19:02,105 - Processing - WARNING - printing schema
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - print schema completed
2024-04-14 21:19:02,106 - Processing - INFO - print schema completed
2024-04-14 21:19:02,106 - Processing - WARNING - printing schema
2024-04-14 21:19:02,106 - Processing - WARNING - printing schema
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:19:02,106 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:19:02,107 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:19:02,107 - Processing - INFO - print schema completed
2024-04-14 21:19:02,107 - Processing - INFO - print schema completed
2024-04-14 21:19:02,107 - root - INFO - creating view
2024-04-14 21:19:02,107 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:19:02,107 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:19:02,124 - Transformation - WARNING - views created successfully
2024-04-14 21:19:02,124 - Transformation - WARNING - views created successfully
2024-04-14 21:19:02,124 - root - INFO - Calculating Insights
2024-04-14 21:19:02,124 - root - INFO - Calculating total zips count in city view
2024-04-14 21:19:02,195 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:19:02,195 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:19:02,195 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:19:02,195 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:19:04,878 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:19:04,878 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:19:04,878 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:19:04,878 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:19:07,603 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:19:07,603 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:19:07,603 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:19:07,603 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:19:07,662 - Transformation - ERROR - an error occured while calculating presc_report
2024-04-14 21:19:07,662 - Transformation - ERROR - an error occured while calculating presc_report
2024-04-14 21:19:07,662 - root - INFO - Application done
2024-04-14 21:20:38,423 - root - INFO - I am in the main method
2024-04-14 21:20:38,423 - root - INFO - Calling spark object
2024-04-14 21:20:38,423 - Create_spark - INFO - Creating spark object
2024-04-14 21:20:38,423 - Create_spark - INFO - Creating spark object
2024-04-14 21:20:38,423 - Create_spark - INFO - master is local
2024-04-14 21:20:38,423 - Create_spark - INFO - master is local
2024-04-14 21:20:45,274 - Create_spark - INFO - Spark object created
2024-04-14 21:20:45,274 - Create_spark - INFO - Spark object created
2024-04-14 21:20:45,274 - root - INFO - Validating spark object
2024-04-14 21:20:45,274 - Validate - WARNING - Started the spark object validation
2024-04-14 21:20:45,274 - Validate - WARNING - Started the spark object validation
2024-04-14 21:20:45,893 - Validate - WARNING - Validation completed
2024-04-14 21:20:45,893 - Validate - WARNING - Validation completed
2024-04-14 21:20:45,893 - root - INFO - reading file of format parquet from olap
2024-04-14 21:20:45,894 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:20:45,894 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:20:46,552 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:20:46,552 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:20:46,562 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:20:47,519 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:20:47,519 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:20:47,519 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:20:47,695 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:20:47,695 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:20:47,696 - root - INFO - reading file of format csv from oltp
2024-04-14 21:20:47,696 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:20:47,696 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:20:50,048 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:20:50,048 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:20:50,049 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:20:50,140 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:20:50,140 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:20:50,140 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:20:50,528 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:20:50,528 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:20:50,529 - root - INFO - implementing data_processing
2024-04-14 21:20:50,529 - Processing - WARNING - data clean method started
2024-04-14 21:20:50,529 - Processing - WARNING - data clean method started
2024-04-14 21:21:01,136 - Processing - WARNING - data cleaning completed
2024-04-14 21:21:01,136 - Processing - WARNING - data cleaning completed
2024-04-14 21:21:01,244 - root - INFO - checking schema
2024-04-14 21:21:01,244 - Processing - WARNING - printing schema
2024-04-14 21:21:01,244 - Processing - WARNING - printing schema
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:21:01,245 - Processing - INFO - print schema completed
2024-04-14 21:21:01,245 - Processing - INFO - print schema completed
2024-04-14 21:21:01,246 - Processing - WARNING - printing schema
2024-04-14 21:21:01,246 - Processing - WARNING - printing schema
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:21:01,246 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:21:01,246 - Processing - INFO - print schema completed
2024-04-14 21:21:01,246 - Processing - INFO - print schema completed
2024-04-14 21:21:01,246 - root - INFO - creating view
2024-04-14 21:21:01,246 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:21:01,246 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:21:01,268 - Transformation - WARNING - views created successfully
2024-04-14 21:21:01,268 - Transformation - WARNING - views created successfully
2024-04-14 21:21:01,268 - root - INFO - Calculating Insights
2024-04-14 21:21:01,268 - root - INFO - Calculating total zips count in city view
2024-04-14 21:21:01,322 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:21:01,322 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:21:01,322 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:21:01,322 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:21:04,159 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:21:04,159 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:21:04,159 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:21:04,159 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:21:07,051 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:21:07,051 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:21:07,053 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 21:21:07,053 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 21:21:10,375 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:21:10,375 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:21:10,375 - root - INFO - Application done
2024-04-14 21:21:37,068 - root - INFO - I am in the main method
2024-04-14 21:21:37,068 - root - INFO - Calling spark object
2024-04-14 21:21:37,068 - Create_spark - INFO - Creating spark object
2024-04-14 21:21:37,068 - Create_spark - INFO - Creating spark object
2024-04-14 21:21:37,068 - Create_spark - INFO - master is local
2024-04-14 21:21:37,068 - Create_spark - INFO - master is local
2024-04-14 21:21:43,552 - Create_spark - INFO - Spark object created
2024-04-14 21:21:43,552 - Create_spark - INFO - Spark object created
2024-04-14 21:21:43,552 - root - INFO - Validating spark object
2024-04-14 21:21:43,552 - Validate - WARNING - Started the spark object validation
2024-04-14 21:21:43,552 - Validate - WARNING - Started the spark object validation
2024-04-14 21:21:44,119 - Validate - WARNING - Validation completed
2024-04-14 21:21:44,119 - Validate - WARNING - Validation completed
2024-04-14 21:21:44,120 - root - INFO - reading file of format parquet from olap
2024-04-14 21:21:44,120 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:21:44,120 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 21:21:44,731 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:21:44,731 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 21:21:44,741 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:21:45,701 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 21:21:45,701 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:21:45,701 - Ingest - WARNING - counting number of records for df_city
2024-04-14 21:21:45,876 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:21:45,876 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 21:21:45,876 - root - INFO - reading file of format csv from oltp
2024-04-14 21:21:45,876 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:21:45,876 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 21:21:48,301 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:21:48,301 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 21:21:48,302 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:21:48,403 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 21:21:48,403 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:21:48,403 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 21:21:48,756 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:21:48,756 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 21:21:48,756 - root - INFO - implementing data_processing
2024-04-14 21:21:48,756 - Processing - WARNING - data clean method started
2024-04-14 21:21:48,756 - Processing - WARNING - data clean method started
2024-04-14 21:21:59,413 - Processing - WARNING - data cleaning completed
2024-04-14 21:21:59,413 - Processing - WARNING - data cleaning completed
2024-04-14 21:21:59,635 - root - INFO - checking schema
2024-04-14 21:21:59,635 - Processing - WARNING - printing schema
2024-04-14 21:21:59,635 - Processing - WARNING - printing schema
2024-04-14 21:21:59,636 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:21:59,636 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 21:21:59,638 - Processing - INFO - print schema completed
2024-04-14 21:21:59,638 - Processing - INFO - print schema completed
2024-04-14 21:21:59,638 - Processing - WARNING - printing schema
2024-04-14 21:21:59,638 - Processing - WARNING - printing schema
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:21:59,639 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:21:59,640 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 21:21:59,640 - Processing - INFO - print schema completed
2024-04-14 21:21:59,640 - Processing - INFO - print schema completed
2024-04-14 21:21:59,640 - root - INFO - creating view
2024-04-14 21:21:59,640 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:21:59,640 - Transformation - WARNING - creating view from the dataframes
2024-04-14 21:21:59,672 - Transformation - WARNING - views created successfully
2024-04-14 21:21:59,672 - Transformation - WARNING - views created successfully
2024-04-14 21:21:59,672 - root - INFO - Calculating Insights
2024-04-14 21:21:59,672 - root - INFO - Calculating total zips count in city view
2024-04-14 21:21:59,733 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:21:59,733 - Transformation - WARNING - zips count calculated successfully
2024-04-14 21:21:59,733 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:21:59,733 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 21:22:02,677 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:22:02,677 - Transformation - WARNING - presc_report calculation successful
2024-04-14 21:22:02,677 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:22:02,677 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 21:22:05,599 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:22:05,599 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 21:22:05,599 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 21:22:05,599 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 21:22:09,101 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 21:22:09,101 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 21:22:09,101 - root - INFO - Application done
2024-04-14 22:44:08,089 - root - INFO - I am in the main method
2024-04-14 22:44:08,090 - root - INFO - Calling spark object
2024-04-14 22:44:08,090 - Create_spark - INFO - Creating spark object
2024-04-14 22:44:08,090 - Create_spark - INFO - Creating spark object
2024-04-14 22:44:08,090 - Create_spark - INFO - master is local
2024-04-14 22:44:08,090 - Create_spark - INFO - master is local
2024-04-14 22:44:14,931 - Create_spark - INFO - Spark object created
2024-04-14 22:44:14,931 - Create_spark - INFO - Spark object created
2024-04-14 22:44:14,931 - root - INFO - Validating spark object
2024-04-14 22:44:14,931 - Validate - WARNING - Started the spark object validation
2024-04-14 22:44:14,931 - Validate - WARNING - Started the spark object validation
2024-04-14 22:44:15,560 - Validate - WARNING - Validation completed
2024-04-14 22:44:15,560 - Validate - WARNING - Validation completed
2024-04-14 22:44:15,561 - root - INFO - reading file of format parquet from olap
2024-04-14 22:44:15,561 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:44:15,561 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:44:16,314 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:44:16,314 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:44:16,324 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:44:17,272 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:44:17,272 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:44:17,272 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:44:17,439 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:44:17,439 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:44:17,439 - root - INFO - reading file of format csv from oltp
2024-04-14 22:44:17,440 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:44:17,440 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:44:19,817 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:44:19,817 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:44:19,818 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:44:19,925 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:44:19,925 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:44:19,925 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:44:20,268 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:44:20,268 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:44:20,268 - root - INFO - implementing data_processing
2024-04-14 22:44:20,268 - Processing - WARNING - data clean method started
2024-04-14 22:44:20,268 - Processing - WARNING - data clean method started
2024-04-14 22:44:31,018 - Processing - WARNING - data cleaning completed
2024-04-14 22:44:31,018 - Processing - WARNING - data cleaning completed
2024-04-14 22:44:31,136 - root - INFO - checking schema
2024-04-14 22:44:31,137 - Processing - WARNING - printing schema
2024-04-14 22:44:31,137 - Processing - WARNING - printing schema
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:44:31,137 - Processing - INFO - print schema completed
2024-04-14 22:44:31,137 - Processing - INFO - print schema completed
2024-04-14 22:44:31,137 - Processing - WARNING - printing schema
2024-04-14 22:44:31,137 - Processing - WARNING - printing schema
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:44:31,138 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:44:31,138 - Processing - INFO - print schema completed
2024-04-14 22:44:31,138 - Processing - INFO - print schema completed
2024-04-14 22:44:31,138 - root - INFO - creating view
2024-04-14 22:44:31,138 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:44:31,138 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:44:31,154 - Transformation - WARNING - views created successfully
2024-04-14 22:44:31,154 - Transformation - WARNING - views created successfully
2024-04-14 22:44:31,154 - root - INFO - Calculating Insights
2024-04-14 22:44:31,154 - root - INFO - Calculating total zips count in city view
2024-04-14 22:44:31,215 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:44:31,215 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:44:31,215 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:44:31,215 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:44:34,005 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:44:34,005 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:44:34,005 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:44:34,005 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:44:36,818 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:44:36,818 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:44:36,818 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:44:36,818 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:44:40,187 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:44:40,187 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:44:40,187 - root - INFO - Application done
2024-04-14 22:45:44,990 - root - INFO - I am in the main method
2024-04-14 22:45:44,990 - root - INFO - Calling spark object
2024-04-14 22:45:44,990 - Create_spark - INFO - Creating spark object
2024-04-14 22:45:44,990 - Create_spark - INFO - Creating spark object
2024-04-14 22:45:44,991 - Create_spark - INFO - master is local
2024-04-14 22:45:44,991 - Create_spark - INFO - master is local
2024-04-14 22:45:51,435 - Create_spark - INFO - Spark object created
2024-04-14 22:45:51,435 - Create_spark - INFO - Spark object created
2024-04-14 22:45:51,436 - root - INFO - Validating spark object
2024-04-14 22:45:51,436 - Validate - WARNING - Started the spark object validation
2024-04-14 22:45:51,436 - Validate - WARNING - Started the spark object validation
2024-04-14 22:45:51,997 - Validate - WARNING - Validation completed
2024-04-14 22:45:51,997 - Validate - WARNING - Validation completed
2024-04-14 22:45:51,998 - root - INFO - reading file of format parquet from olap
2024-04-14 22:45:51,998 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:45:51,998 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:45:52,666 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:45:52,666 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:45:52,676 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:45:53,580 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:45:53,580 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:45:53,580 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:45:53,740 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:45:53,740 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:45:53,741 - root - INFO - reading file of format csv from oltp
2024-04-14 22:45:53,741 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:45:53,741 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:45:56,017 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:45:56,017 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:45:56,018 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:45:56,112 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:45:56,112 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:45:56,112 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:45:56,460 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:45:56,460 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:45:56,460 - root - INFO - implementing data_processing
2024-04-14 22:45:56,460 - Processing - WARNING - data clean method started
2024-04-14 22:45:56,460 - Processing - WARNING - data clean method started
2024-04-14 22:46:07,077 - Processing - WARNING - data cleaning completed
2024-04-14 22:46:07,077 - Processing - WARNING - data cleaning completed
2024-04-14 22:46:07,175 - root - INFO - checking schema
2024-04-14 22:46:07,175 - Processing - WARNING - printing schema
2024-04-14 22:46:07,175 - Processing - WARNING - printing schema
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:46:07,175 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - print schema completed
2024-04-14 22:46:07,176 - Processing - INFO - print schema completed
2024-04-14 22:46:07,176 - Processing - WARNING - printing schema
2024-04-14 22:46:07,176 - Processing - WARNING - printing schema
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:46:07,176 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:46:07,176 - Processing - INFO - print schema completed
2024-04-14 22:46:07,176 - Processing - INFO - print schema completed
2024-04-14 22:46:07,176 - root - INFO - creating view
2024-04-14 22:46:07,176 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:46:07,176 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:46:07,192 - Transformation - WARNING - views created successfully
2024-04-14 22:46:07,192 - Transformation - WARNING - views created successfully
2024-04-14 22:46:07,192 - root - INFO - Calculating Insights
2024-04-14 22:46:07,192 - root - INFO - Calculating total zips count in city view
2024-04-14 22:46:07,247 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:46:07,247 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:46:07,247 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:46:07,247 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:46:09,914 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:46:09,914 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:46:09,914 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:46:09,914 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:46:12,674 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:46:12,674 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:46:12,674 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:46:12,674 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:46:15,650 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:46:15,650 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:46:15,651 - root - INFO - Application done
2024-04-14 22:47:15,085 - root - INFO - I am in the main method
2024-04-14 22:47:15,085 - root - INFO - Calling spark object
2024-04-14 22:47:15,085 - Create_spark - INFO - Creating spark object
2024-04-14 22:47:15,085 - Create_spark - INFO - Creating spark object
2024-04-14 22:47:15,086 - Create_spark - INFO - master is local
2024-04-14 22:47:15,086 - Create_spark - INFO - master is local
2024-04-14 22:47:21,822 - Create_spark - INFO - Spark object created
2024-04-14 22:47:21,822 - Create_spark - INFO - Spark object created
2024-04-14 22:47:21,822 - root - INFO - Validating spark object
2024-04-14 22:47:21,822 - Validate - WARNING - Started the spark object validation
2024-04-14 22:47:21,822 - Validate - WARNING - Started the spark object validation
2024-04-14 22:47:22,445 - Validate - WARNING - Validation completed
2024-04-14 22:47:22,445 - Validate - WARNING - Validation completed
2024-04-14 22:47:22,446 - root - INFO - reading file of format parquet from olap
2024-04-14 22:47:22,446 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:47:22,446 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:47:23,150 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:47:23,150 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:47:23,161 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:47:24,098 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:47:24,098 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:47:24,098 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:47:24,268 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:47:24,268 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:47:24,269 - root - INFO - reading file of format csv from oltp
2024-04-14 22:47:24,269 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:47:24,269 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:47:26,607 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:47:26,607 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:47:26,608 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:47:26,709 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:47:26,709 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:47:26,709 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:47:27,056 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:47:27,056 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:47:27,056 - root - INFO - implementing data_processing
2024-04-14 22:47:27,056 - Processing - WARNING - data clean method started
2024-04-14 22:47:27,056 - Processing - WARNING - data clean method started
2024-04-14 22:47:37,661 - Processing - WARNING - data cleaning completed
2024-04-14 22:47:37,661 - Processing - WARNING - data cleaning completed
2024-04-14 22:47:37,778 - root - INFO - checking schema
2024-04-14 22:47:37,778 - Processing - WARNING - printing schema
2024-04-14 22:47:37,778 - Processing - WARNING - printing schema
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:47:37,778 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - print schema completed
2024-04-14 22:47:37,779 - Processing - INFO - print schema completed
2024-04-14 22:47:37,779 - Processing - WARNING - printing schema
2024-04-14 22:47:37,779 - Processing - WARNING - printing schema
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:47:37,779 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:47:37,779 - Processing - INFO - print schema completed
2024-04-14 22:47:37,779 - Processing - INFO - print schema completed
2024-04-14 22:47:37,779 - root - INFO - creating view
2024-04-14 22:47:37,779 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:47:37,779 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:47:37,795 - Transformation - WARNING - views created successfully
2024-04-14 22:47:37,795 - Transformation - WARNING - views created successfully
2024-04-14 22:47:37,795 - root - INFO - Calculating Insights
2024-04-14 22:47:37,795 - root - INFO - Calculating total zips count in city view
2024-04-14 22:47:37,864 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:47:37,864 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:47:37,864 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:47:37,864 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:47:40,726 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:47:40,726 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:47:40,726 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:47:40,726 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:47:43,555 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:47:43,555 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:47:43,555 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:47:43,555 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:47:46,920 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:47:46,920 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:47:46,920 - root - INFO - Application done
2024-04-14 22:48:11,169 - root - INFO - I am in the main method
2024-04-14 22:48:11,169 - root - INFO - Calling spark object
2024-04-14 22:48:11,169 - Create_spark - INFO - Creating spark object
2024-04-14 22:48:11,169 - Create_spark - INFO - Creating spark object
2024-04-14 22:48:11,169 - Create_spark - INFO - master is local
2024-04-14 22:48:11,169 - Create_spark - INFO - master is local
2024-04-14 22:48:17,769 - Create_spark - INFO - Spark object created
2024-04-14 22:48:17,769 - Create_spark - INFO - Spark object created
2024-04-14 22:48:17,769 - root - INFO - Validating spark object
2024-04-14 22:48:17,769 - Validate - WARNING - Started the spark object validation
2024-04-14 22:48:17,769 - Validate - WARNING - Started the spark object validation
2024-04-14 22:48:18,331 - Validate - WARNING - Validation completed
2024-04-14 22:48:18,331 - Validate - WARNING - Validation completed
2024-04-14 22:48:18,332 - root - INFO - reading file of format parquet from olap
2024-04-14 22:48:18,332 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:48:18,332 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:48:18,921 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:48:18,921 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:48:18,931 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:48:19,871 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:48:19,871 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:48:19,871 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:48:20,041 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:48:20,041 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:48:20,042 - root - INFO - reading file of format csv from oltp
2024-04-14 22:48:20,042 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:48:20,042 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:48:22,306 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:48:22,306 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:48:22,308 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:48:22,409 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:48:22,409 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:48:22,409 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:48:22,752 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:48:22,752 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:48:22,753 - root - INFO - implementing data_processing
2024-04-14 22:48:22,753 - Processing - WARNING - data clean method started
2024-04-14 22:48:22,753 - Processing - WARNING - data clean method started
2024-04-14 22:48:33,248 - Processing - WARNING - data cleaning completed
2024-04-14 22:48:33,248 - Processing - WARNING - data cleaning completed
2024-04-14 22:48:33,362 - root - INFO - checking schema
2024-04-14 22:48:33,363 - Processing - WARNING - printing schema
2024-04-14 22:48:33,363 - Processing - WARNING - printing schema
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:48:33,363 - Processing - INFO - print schema completed
2024-04-14 22:48:33,363 - Processing - INFO - print schema completed
2024-04-14 22:48:33,363 - Processing - WARNING - printing schema
2024-04-14 22:48:33,363 - Processing - WARNING - printing schema
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:48:33,364 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:48:33,364 - Processing - INFO - print schema completed
2024-04-14 22:48:33,364 - Processing - INFO - print schema completed
2024-04-14 22:48:33,364 - root - INFO - creating view
2024-04-14 22:48:33,364 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:48:33,364 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:48:33,380 - Transformation - WARNING - views created successfully
2024-04-14 22:48:33,380 - Transformation - WARNING - views created successfully
2024-04-14 22:48:33,380 - root - INFO - Calculating Insights
2024-04-14 22:48:33,380 - root - INFO - Calculating total zips count in city view
2024-04-14 22:48:33,447 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:48:33,447 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:48:33,447 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:48:33,447 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:48:36,169 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:48:36,169 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:48:36,169 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:48:36,169 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:48:38,985 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:48:38,985 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:48:38,985 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:48:38,985 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:48:42,250 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:48:42,250 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:48:42,250 - root - INFO - Application done
2024-04-14 22:50:01,831 - root - INFO - I am in the main method
2024-04-14 22:50:01,831 - root - INFO - Calling spark object
2024-04-14 22:50:01,831 - Create_spark - INFO - Creating spark object
2024-04-14 22:50:01,831 - Create_spark - INFO - Creating spark object
2024-04-14 22:50:01,831 - Create_spark - INFO - master is local
2024-04-14 22:50:01,831 - Create_spark - INFO - master is local
2024-04-14 22:50:08,653 - Create_spark - INFO - Spark object created
2024-04-14 22:50:08,653 - Create_spark - INFO - Spark object created
2024-04-14 22:50:08,653 - root - INFO - Validating spark object
2024-04-14 22:50:08,653 - Validate - WARNING - Started the spark object validation
2024-04-14 22:50:08,653 - Validate - WARNING - Started the spark object validation
2024-04-14 22:50:09,286 - Validate - WARNING - Validation completed
2024-04-14 22:50:09,286 - Validate - WARNING - Validation completed
2024-04-14 22:50:09,287 - root - INFO - reading file of format parquet from olap
2024-04-14 22:50:09,287 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:50:09,287 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:50:09,937 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:50:09,937 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:50:09,947 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:50:10,912 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:50:10,912 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:50:10,912 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:50:11,093 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:50:11,093 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:50:11,093 - root - INFO - reading file of format csv from oltp
2024-04-14 22:50:11,093 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:50:11,093 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:50:13,464 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:50:13,464 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:50:13,465 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:50:13,580 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:50:13,580 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:50:13,580 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:50:13,938 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:50:13,938 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:50:13,938 - root - INFO - implementing data_processing
2024-04-14 22:50:13,938 - Processing - WARNING - data clean method started
2024-04-14 22:50:13,938 - Processing - WARNING - data clean method started
2024-04-14 22:50:24,764 - Processing - WARNING - data cleaning completed
2024-04-14 22:50:24,764 - Processing - WARNING - data cleaning completed
2024-04-14 22:50:24,893 - root - INFO - checking schema
2024-04-14 22:50:24,893 - Processing - WARNING - printing schema
2024-04-14 22:50:24,893 - Processing - WARNING - printing schema
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:50:24,893 - Processing - INFO - print schema completed
2024-04-14 22:50:24,893 - Processing - INFO - print schema completed
2024-04-14 22:50:24,893 - Processing - WARNING - printing schema
2024-04-14 22:50:24,893 - Processing - WARNING - printing schema
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:50:24,894 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:50:24,894 - Processing - INFO - print schema completed
2024-04-14 22:50:24,894 - Processing - INFO - print schema completed
2024-04-14 22:50:24,894 - root - INFO - creating view
2024-04-14 22:50:24,894 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:50:24,894 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:50:24,911 - Transformation - WARNING - views created successfully
2024-04-14 22:50:24,911 - Transformation - WARNING - views created successfully
2024-04-14 22:50:24,912 - root - INFO - Calculating Insights
2024-04-14 22:50:24,912 - root - INFO - Calculating total zips count in city view
2024-04-14 22:50:24,988 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:50:24,988 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:50:24,988 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:50:24,988 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:50:27,896 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:50:27,896 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:50:27,896 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:50:27,896 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:50:30,727 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:50:30,727 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:50:30,727 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:50:30,727 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:50:34,197 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:50:34,197 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:50:34,198 - root - INFO - Application done
2024-04-14 22:53:32,348 - root - INFO - I am in the main method
2024-04-14 22:53:32,350 - root - INFO - Calling spark object
2024-04-14 22:53:32,350 - Create_spark - INFO - Creating spark object
2024-04-14 22:53:32,350 - Create_spark - INFO - Creating spark object
2024-04-14 22:53:32,350 - Create_spark - INFO - master is local
2024-04-14 22:53:32,350 - Create_spark - INFO - master is local
2024-04-14 22:53:39,190 - Create_spark - INFO - Spark object created
2024-04-14 22:53:39,190 - Create_spark - INFO - Spark object created
2024-04-14 22:53:39,190 - root - INFO - Validating spark object
2024-04-14 22:53:39,190 - Validate - WARNING - Started the spark object validation
2024-04-14 22:53:39,190 - Validate - WARNING - Started the spark object validation
2024-04-14 22:53:39,812 - Validate - WARNING - Validation completed
2024-04-14 22:53:39,812 - Validate - WARNING - Validation completed
2024-04-14 22:53:39,813 - root - INFO - reading file of format parquet from olap
2024-04-14 22:53:39,813 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:53:39,813 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 22:53:40,496 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:53:40,496 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 22:53:40,506 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:53:41,484 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 22:53:41,484 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:53:41,484 - Ingest - WARNING - counting number of records for df_city
2024-04-14 22:53:41,663 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:53:41,663 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 22:53:41,663 - root - INFO - reading file of format csv from oltp
2024-04-14 22:53:41,663 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:53:41,663 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 22:53:44,091 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:53:44,091 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 22:53:44,092 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:53:44,198 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 22:53:44,198 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:53:44,198 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 22:53:44,575 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:53:44,575 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 22:53:44,576 - root - INFO - implementing data_processing
2024-04-14 22:53:44,576 - Processing - WARNING - data clean method started
2024-04-14 22:53:44,576 - Processing - WARNING - data clean method started
2024-04-14 22:53:55,317 - Processing - WARNING - data cleaning completed
2024-04-14 22:53:55,317 - Processing - WARNING - data cleaning completed
2024-04-14 22:53:55,429 - root - INFO - checking schema
2024-04-14 22:53:55,429 - Processing - WARNING - printing schema
2024-04-14 22:53:55,429 - Processing - WARNING - printing schema
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 22:53:55,429 - Processing - INFO - print schema completed
2024-04-14 22:53:55,429 - Processing - INFO - print schema completed
2024-04-14 22:53:55,430 - Processing - WARNING - printing schema
2024-04-14 22:53:55,430 - Processing - WARNING - printing schema
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:53:55,430 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 22:53:55,430 - Processing - INFO - print schema completed
2024-04-14 22:53:55,430 - Processing - INFO - print schema completed
2024-04-14 22:53:55,430 - root - INFO - creating view
2024-04-14 22:53:55,430 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:53:55,430 - Transformation - WARNING - creating view from the dataframes
2024-04-14 22:53:55,446 - Transformation - WARNING - views created successfully
2024-04-14 22:53:55,446 - Transformation - WARNING - views created successfully
2024-04-14 22:53:55,446 - root - INFO - Calculating Insights
2024-04-14 22:53:55,446 - root - INFO - Calculating total zips count in city view
2024-04-14 22:53:55,513 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:53:55,513 - Transformation - WARNING - zips count calculated successfully
2024-04-14 22:53:55,513 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:53:55,513 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 22:53:58,386 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:53:58,386 - Transformation - WARNING - presc_report calculation successful
2024-04-14 22:53:58,386 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:53:58,386 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 22:54:01,218 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:54:01,218 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 22:54:01,219 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:54:01,219 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 22:54:04,665 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:54:04,665 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 22:54:04,665 - root - INFO - Application done
2024-04-14 23:14:43,556 - root - INFO - I am in the main method
2024-04-14 23:14:43,556 - root - INFO - Calling spark object
2024-04-14 23:14:43,556 - Create_spark - INFO - Creating spark object
2024-04-14 23:14:43,556 - Create_spark - INFO - Creating spark object
2024-04-14 23:14:43,556 - Create_spark - INFO - master is local
2024-04-14 23:14:43,556 - Create_spark - INFO - master is local
2024-04-14 23:14:50,401 - Create_spark - INFO - Spark object created
2024-04-14 23:14:50,401 - Create_spark - INFO - Spark object created
2024-04-14 23:14:50,401 - root - INFO - Validating spark object
2024-04-14 23:14:50,401 - Validate - WARNING - Started the spark object validation
2024-04-14 23:14:50,401 - Validate - WARNING - Started the spark object validation
2024-04-14 23:14:51,057 - Validate - WARNING - Validation completed
2024-04-14 23:14:51,057 - Validate - WARNING - Validation completed
2024-04-14 23:14:51,058 - root - INFO - reading file of format parquet from olap
2024-04-14 23:14:51,058 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:14:51,058 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:14:51,751 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:14:51,751 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:14:51,761 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:14:53,062 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:14:53,062 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:14:53,062 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:14:53,242 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:14:53,242 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:14:53,242 - root - INFO - reading file of format csv from oltp
2024-04-14 23:14:53,242 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:14:53,242 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:14:55,674 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:14:55,674 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:14:55,676 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:14:55,778 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:14:55,778 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:14:55,778 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:14:56,133 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:14:56,133 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:14:56,134 - root - INFO - implementing data_processing
2024-04-14 23:14:56,134 - Processing - WARNING - data clean method started
2024-04-14 23:14:56,134 - Processing - WARNING - data clean method started
2024-04-14 23:15:07,245 - Processing - WARNING - data cleaning completed
2024-04-14 23:15:07,245 - Processing - WARNING - data cleaning completed
2024-04-14 23:15:07,349 - root - INFO - checking schema
2024-04-14 23:15:07,349 - Processing - WARNING - printing schema
2024-04-14 23:15:07,349 - Processing - WARNING - printing schema
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:15:07,349 - Processing - INFO - print schema completed
2024-04-14 23:15:07,349 - Processing - INFO - print schema completed
2024-04-14 23:15:07,349 - Processing - WARNING - printing schema
2024-04-14 23:15:07,349 - Processing - WARNING - printing schema
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:15:07,350 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:15:07,350 - Processing - INFO - print schema completed
2024-04-14 23:15:07,350 - Processing - INFO - print schema completed
2024-04-14 23:15:07,350 - root - INFO - creating view
2024-04-14 23:15:07,350 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:15:07,350 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:15:07,369 - Transformation - WARNING - views created successfully
2024-04-14 23:15:07,369 - Transformation - WARNING - views created successfully
2024-04-14 23:15:07,369 - root - INFO - Calculating Insights
2024-04-14 23:15:07,369 - root - INFO - Calculating total zips count in city view
2024-04-14 23:15:07,430 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:15:07,430 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:15:07,430 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:15:07,430 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:15:10,249 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:15:10,249 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:15:10,250 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:15:10,250 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:15:13,054 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:15:13,054 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:15:13,054 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:15:13,054 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:15:16,456 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:15:16,456 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:36:50,209 - root - INFO - I am in the main method
2024-04-14 23:36:50,209 - root - INFO - Calling spark object
2024-04-14 23:36:50,209 - Create_spark - INFO - Creating spark object
2024-04-14 23:36:50,209 - Create_spark - INFO - Creating spark object
2024-04-14 23:36:50,209 - Create_spark - INFO - master is local
2024-04-14 23:36:50,209 - Create_spark - INFO - master is local
2024-04-14 23:36:57,050 - Create_spark - INFO - Spark object created
2024-04-14 23:36:57,050 - Create_spark - INFO - Spark object created
2024-04-14 23:36:57,051 - root - INFO - Validating spark object
2024-04-14 23:36:57,051 - Validate - WARNING - Started the spark object validation
2024-04-14 23:36:57,051 - Validate - WARNING - Started the spark object validation
2024-04-14 23:36:57,672 - Validate - WARNING - Validation completed
2024-04-14 23:36:57,672 - Validate - WARNING - Validation completed
2024-04-14 23:36:57,672 - root - INFO - reading file of format parquet from olap
2024-04-14 23:36:57,672 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:36:57,672 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:36:58,362 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:36:58,362 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:36:58,372 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:36:59,312 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:36:59,312 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:36:59,312 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:36:59,486 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:36:59,486 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:36:59,486 - root - INFO - reading file of format csv from oltp
2024-04-14 23:36:59,486 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:36:59,486 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:37:02,067 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:37:02,067 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:37:02,069 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:37:02,256 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:37:02,256 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:37:02,256 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:37:02,724 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:37:02,724 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:37:02,724 - root - INFO - implementing data_processing
2024-04-14 23:37:02,724 - Processing - WARNING - data clean method started
2024-04-14 23:37:02,724 - Processing - WARNING - data clean method started
2024-04-14 23:37:13,583 - Processing - WARNING - data cleaning completed
2024-04-14 23:37:13,583 - Processing - WARNING - data cleaning completed
2024-04-14 23:37:13,703 - root - INFO - checking schema
2024-04-14 23:37:13,703 - Processing - WARNING - printing schema
2024-04-14 23:37:13,703 - Processing - WARNING - printing schema
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:37:13,703 - Processing - INFO - print schema completed
2024-04-14 23:37:13,703 - Processing - INFO - print schema completed
2024-04-14 23:37:13,703 - Processing - WARNING - printing schema
2024-04-14 23:37:13,703 - Processing - WARNING - printing schema
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:37:13,704 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:37:13,704 - Processing - INFO - print schema completed
2024-04-14 23:37:13,704 - Processing - INFO - print schema completed
2024-04-14 23:37:13,704 - root - INFO - creating view
2024-04-14 23:37:13,704 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:37:13,704 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:37:13,721 - Transformation - WARNING - views created successfully
2024-04-14 23:37:13,721 - Transformation - WARNING - views created successfully
2024-04-14 23:37:13,721 - root - INFO - Calculating Insights
2024-04-14 23:37:13,721 - root - INFO - Calculating total zips count in city view
2024-04-14 23:37:13,787 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:37:13,787 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:37:13,787 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:37:13,787 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:37:16,616 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:37:16,616 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:37:16,616 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:37:16,616 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:37:19,496 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:37:19,496 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:37:19,496 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:37:19,496 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:37:22,888 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:37:22,888 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:37:22,888 - root - INFO - the process time  32.68 seconds
2024-04-14 23:37:22,888 - root - INFO - Application done
2024-04-14 23:38:14,799 - root - INFO - I am in the main method
2024-04-14 23:38:14,799 - root - INFO - Calling spark object
2024-04-14 23:38:14,799 - Create_spark - INFO - Creating spark object
2024-04-14 23:38:14,799 - Create_spark - INFO - Creating spark object
2024-04-14 23:38:14,799 - Create_spark - INFO - master is local
2024-04-14 23:38:14,799 - Create_spark - INFO - master is local
2024-04-14 23:38:21,565 - Create_spark - INFO - Spark object created
2024-04-14 23:38:21,565 - Create_spark - INFO - Spark object created
2024-04-14 23:38:21,565 - root - INFO - Validating spark object
2024-04-14 23:38:21,565 - Validate - WARNING - Started the spark object validation
2024-04-14 23:38:21,565 - Validate - WARNING - Started the spark object validation
2024-04-14 23:38:22,195 - Validate - WARNING - Validation completed
2024-04-14 23:38:22,195 - Validate - WARNING - Validation completed
2024-04-14 23:38:22,196 - root - INFO - reading file of format parquet from olap
2024-04-14 23:38:22,196 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:38:22,196 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-14 23:38:22,856 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:38:22,856 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-14 23:38:22,866 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:38:23,881 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-14 23:38:23,881 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:38:23,881 - Ingest - WARNING - counting number of records for df_city
2024-04-14 23:38:24,070 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:38:24,070 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-14 23:38:24,070 - root - INFO - reading file of format csv from oltp
2024-04-14 23:38:24,070 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:38:24,070 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-14 23:38:26,625 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:38:26,625 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-14 23:38:26,626 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:38:26,738 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-14 23:38:26,738 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:38:26,738 - Ingest - WARNING - counting number of records for df_fact
2024-04-14 23:38:27,130 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:38:27,130 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-14 23:38:27,130 - root - INFO - implementing data_processing
2024-04-14 23:38:27,130 - Processing - WARNING - data clean method started
2024-04-14 23:38:27,130 - Processing - WARNING - data clean method started
2024-04-14 23:38:37,751 - Processing - WARNING - data cleaning completed
2024-04-14 23:38:37,751 - Processing - WARNING - data cleaning completed
2024-04-14 23:38:37,853 - root - INFO - checking schema
2024-04-14 23:38:37,853 - Processing - WARNING - printing schema
2024-04-14 23:38:37,853 - Processing - WARNING - printing schema
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - print schema completed
2024-04-14 23:38:37,854 - Processing - INFO - print schema completed
2024-04-14 23:38:37,854 - Processing - WARNING - printing schema
2024-04-14 23:38:37,854 - Processing - WARNING - printing schema
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:38:37,854 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:38:37,855 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-14 23:38:37,855 - Processing - INFO - print schema completed
2024-04-14 23:38:37,855 - Processing - INFO - print schema completed
2024-04-14 23:38:37,855 - root - INFO - creating view
2024-04-14 23:38:37,855 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:38:37,855 - Transformation - WARNING - creating view from the dataframes
2024-04-14 23:38:37,871 - Transformation - WARNING - views created successfully
2024-04-14 23:38:37,871 - Transformation - WARNING - views created successfully
2024-04-14 23:38:37,871 - root - INFO - Calculating Insights
2024-04-14 23:38:37,871 - root - INFO - Calculating total zips count in city view
2024-04-14 23:38:37,930 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:38:37,930 - Transformation - WARNING - zips count calculated successfully
2024-04-14 23:38:37,930 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:38:37,930 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-14 23:38:40,699 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:38:40,699 - Transformation - WARNING - presc_report calculation successful
2024-04-14 23:38:40,699 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:38:40,699 - Transformation - INFO - Calculating cities with prescribers
2024-04-14 23:38:43,474 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:38:43,474 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-14 23:38:43,474 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:38:43,474 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-14 23:38:43,536 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:38:43,536 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-14 23:38:43,536 - root - INFO - the process time  28.74 seconds
2024-04-14 23:38:43,536 - root - INFO - Application done
2024-04-15 06:57:09,582 - root - INFO - I am in the main method
2024-04-15 06:57:09,582 - root - INFO - Calling spark object
2024-04-15 06:57:09,582 - Create_spark - INFO - Creating spark object
2024-04-15 06:57:09,582 - Create_spark - INFO - Creating spark object
2024-04-15 06:57:09,582 - Create_spark - INFO - master is local
2024-04-15 06:57:09,582 - Create_spark - INFO - master is local
2024-04-15 06:57:16,539 - Create_spark - INFO - Spark object created
2024-04-15 06:57:16,539 - Create_spark - INFO - Spark object created
2024-04-15 06:57:16,539 - root - INFO - Validating spark object
2024-04-15 06:57:16,539 - Validate - WARNING - Started the spark object validation
2024-04-15 06:57:16,539 - Validate - WARNING - Started the spark object validation
2024-04-15 06:57:17,161 - Validate - WARNING - Validation completed
2024-04-15 06:57:17,161 - Validate - WARNING - Validation completed
2024-04-15 06:57:17,161 - root - INFO - reading file of format parquet from olap
2024-04-15 06:57:17,161 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 06:57:17,161 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 06:57:17,930 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 06:57:17,930 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 06:57:17,940 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 06:57:19,354 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 06:57:19,354 - Ingest - WARNING - counting number of records for df_city
2024-04-15 06:57:19,354 - Ingest - WARNING - counting number of records for df_city
2024-04-15 06:57:19,515 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 06:57:19,515 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 06:57:19,515 - root - INFO - reading file of format csv from oltp
2024-04-15 06:57:19,515 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 06:57:19,515 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 06:57:21,961 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 06:57:21,961 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 06:57:21,962 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 06:57:22,069 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 06:57:22,069 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 06:57:22,069 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 06:57:22,431 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 06:57:22,431 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 06:57:22,431 - root - INFO - implementing data_processing
2024-04-15 06:57:22,431 - Processing - WARNING - data clean method started
2024-04-15 06:57:22,431 - Processing - WARNING - data clean method started
2024-04-15 06:57:33,003 - Processing - WARNING - data cleaning completed
2024-04-15 06:57:33,003 - Processing - WARNING - data cleaning completed
2024-04-15 06:59:50,931 - root - INFO - I am in the main method
2024-04-15 06:59:50,932 - root - INFO - Calling spark object
2024-04-15 06:59:50,932 - Create_spark - INFO - Creating spark object
2024-04-15 06:59:50,932 - Create_spark - INFO - Creating spark object
2024-04-15 06:59:50,932 - Create_spark - INFO - master is local
2024-04-15 06:59:50,932 - Create_spark - INFO - master is local
2024-04-15 06:59:57,743 - Create_spark - INFO - Spark object created
2024-04-15 06:59:57,743 - Create_spark - INFO - Spark object created
2024-04-15 06:59:57,743 - root - INFO - Validating spark object
2024-04-15 06:59:57,743 - Validate - WARNING - Started the spark object validation
2024-04-15 06:59:57,743 - Validate - WARNING - Started the spark object validation
2024-04-15 06:59:58,361 - Validate - WARNING - Validation completed
2024-04-15 06:59:58,361 - Validate - WARNING - Validation completed
2024-04-15 06:59:58,362 - root - INFO - reading file of format parquet from olap
2024-04-15 06:59:58,362 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 06:59:58,362 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 06:59:58,998 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 06:59:58,998 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 06:59:59,008 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 06:59:59,960 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 06:59:59,960 - Ingest - WARNING - counting number of records for df_city
2024-04-15 06:59:59,960 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:00:00,132 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:00:00,132 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:00:00,132 - root - INFO - reading file of format csv from oltp
2024-04-15 07:00:00,132 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:00:00,132 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:00:02,566 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:00:02,566 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:00:02,567 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:00:02,670 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:00:02,671 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:00:02,671 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:00:03,010 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:00:03,010 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:00:03,011 - root - INFO - implementing data_processing
2024-04-15 07:00:03,011 - Processing - WARNING - data clean method started
2024-04-15 07:00:03,011 - Processing - WARNING - data clean method started
2024-04-15 07:00:13,825 - Processing - WARNING - data cleaning completed
2024-04-15 07:00:13,825 - Processing - WARNING - data cleaning completed
2024-04-15 07:00:37,076 - root - INFO - the process time  46.14 seconds
2024-04-15 07:00:37,077 - root - INFO - Application done
2024-04-15 07:03:49,739 - root - INFO - I am in the main method
2024-04-15 07:03:49,740 - root - INFO - Calling spark object
2024-04-15 07:03:49,740 - Create_spark - INFO - Creating spark object
2024-04-15 07:03:49,740 - Create_spark - INFO - Creating spark object
2024-04-15 07:03:49,740 - Create_spark - INFO - master is local
2024-04-15 07:03:49,740 - Create_spark - INFO - master is local
2024-04-15 07:03:56,474 - Create_spark - INFO - Spark object created
2024-04-15 07:03:56,474 - Create_spark - INFO - Spark object created
2024-04-15 07:03:56,474 - root - INFO - Validating spark object
2024-04-15 07:03:56,474 - Validate - WARNING - Started the spark object validation
2024-04-15 07:03:56,474 - Validate - WARNING - Started the spark object validation
2024-04-15 07:03:57,096 - Validate - WARNING - Validation completed
2024-04-15 07:03:57,096 - Validate - WARNING - Validation completed
2024-04-15 07:03:57,097 - root - INFO - reading file of format parquet from olap
2024-04-15 07:03:57,097 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:03:57,097 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:03:57,713 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:03:57,713 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:03:57,724 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:03:59,152 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:03:59,152 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:03:59,152 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:03:59,313 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:03:59,313 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:03:59,313 - root - INFO - reading file of format csv from oltp
2024-04-15 07:03:59,313 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:03:59,313 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:04:01,686 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:04:01,686 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:04:01,688 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:04:01,791 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:04:01,791 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:04:01,791 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:04:02,143 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:04:02,143 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:04:02,143 - root - INFO - implementing data_processing
2024-04-15 07:04:02,143 - Processing - WARNING - data clean method started
2024-04-15 07:04:02,143 - Processing - WARNING - data clean method started
2024-04-15 07:04:12,884 - Processing - WARNING - data cleaning completed
2024-04-15 07:04:12,884 - Processing - WARNING - data cleaning completed
2024-04-15 07:04:29,695 - root - INFO - I am in the main method
2024-04-15 07:04:29,695 - root - INFO - Calling spark object
2024-04-15 07:04:29,695 - Create_spark - INFO - Creating spark object
2024-04-15 07:04:29,695 - Create_spark - INFO - Creating spark object
2024-04-15 07:04:29,695 - Create_spark - INFO - master is local
2024-04-15 07:04:29,695 - Create_spark - INFO - master is local
2024-04-15 07:04:36,424 - Create_spark - INFO - Spark object created
2024-04-15 07:04:36,424 - Create_spark - INFO - Spark object created
2024-04-15 07:04:36,424 - root - INFO - Validating spark object
2024-04-15 07:04:36,424 - Validate - WARNING - Started the spark object validation
2024-04-15 07:04:36,424 - Validate - WARNING - Started the spark object validation
2024-04-15 07:04:37,039 - Validate - WARNING - Validation completed
2024-04-15 07:04:37,039 - Validate - WARNING - Validation completed
2024-04-15 07:04:37,040 - root - INFO - reading file of format parquet from olap
2024-04-15 07:04:37,040 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:04:37,040 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:04:37,605 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:04:37,605 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:04:37,616 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:04:38,561 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:04:38,561 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:04:38,561 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:04:38,737 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:04:38,737 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:04:38,738 - root - INFO - reading file of format csv from oltp
2024-04-15 07:04:38,738 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:04:38,738 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:04:41,074 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:04:41,074 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:04:41,075 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:04:41,167 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:04:41,167 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:04:41,167 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:04:41,582 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:04:41,582 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:04:41,582 - root - INFO - implementing data_processing
2024-04-15 07:04:41,582 - Processing - WARNING - data clean method started
2024-04-15 07:04:41,582 - Processing - WARNING - data clean method started
2024-04-15 07:04:52,095 - Processing - WARNING - data cleaning completed
2024-04-15 07:04:52,095 - Processing - WARNING - data cleaning completed
2024-04-15 07:04:53,682 - root - INFO - the process time  23.99 seconds
2024-04-15 07:04:53,682 - root - INFO - Application done
2024-04-15 07:05:41,187 - root - INFO - I am in the main method
2024-04-15 07:05:41,187 - root - INFO - Calling spark object
2024-04-15 07:05:41,187 - Create_spark - INFO - Creating spark object
2024-04-15 07:05:41,187 - Create_spark - INFO - Creating spark object
2024-04-15 07:05:41,187 - Create_spark - INFO - master is local
2024-04-15 07:05:41,187 - Create_spark - INFO - master is local
2024-04-15 07:05:47,656 - Create_spark - INFO - Spark object created
2024-04-15 07:05:47,656 - Create_spark - INFO - Spark object created
2024-04-15 07:05:47,656 - root - INFO - Validating spark object
2024-04-15 07:05:47,656 - Validate - WARNING - Started the spark object validation
2024-04-15 07:05:47,656 - Validate - WARNING - Started the spark object validation
2024-04-15 07:05:48,258 - Validate - WARNING - Validation completed
2024-04-15 07:05:48,258 - Validate - WARNING - Validation completed
2024-04-15 07:05:48,258 - root - INFO - reading file of format parquet from olap
2024-04-15 07:05:48,259 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:05:48,259 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:05:48,872 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:05:48,872 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:05:48,883 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:05:49,801 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:05:49,801 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:05:49,801 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:05:49,977 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:05:49,977 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:05:49,978 - root - INFO - reading file of format csv from oltp
2024-04-15 07:05:49,978 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:05:49,978 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:05:52,270 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:05:52,270 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:05:52,271 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:05:52,362 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:05:52,362 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:05:52,362 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:05:52,709 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:05:52,709 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:05:52,709 - root - INFO - implementing data_processing
2024-04-15 07:05:52,709 - Processing - WARNING - data clean method started
2024-04-15 07:05:52,709 - Processing - WARNING - data clean method started
2024-04-15 07:06:03,401 - Processing - WARNING - data cleaning completed
2024-04-15 07:06:03,401 - Processing - WARNING - data cleaning completed
2024-04-15 07:06:18,249 - root - INFO - I am in the main method
2024-04-15 07:06:18,249 - root - INFO - Calling spark object
2024-04-15 07:06:18,249 - Create_spark - INFO - Creating spark object
2024-04-15 07:06:18,249 - Create_spark - INFO - Creating spark object
2024-04-15 07:06:18,249 - Create_spark - INFO - master is local
2024-04-15 07:06:18,249 - Create_spark - INFO - master is local
2024-04-15 07:06:24,726 - Create_spark - INFO - Spark object created
2024-04-15 07:06:24,726 - Create_spark - INFO - Spark object created
2024-04-15 07:06:24,726 - root - INFO - Validating spark object
2024-04-15 07:06:24,726 - Validate - WARNING - Started the spark object validation
2024-04-15 07:06:24,726 - Validate - WARNING - Started the spark object validation
2024-04-15 07:06:25,294 - Validate - WARNING - Validation completed
2024-04-15 07:06:25,294 - Validate - WARNING - Validation completed
2024-04-15 07:06:25,294 - root - INFO - reading file of format parquet from olap
2024-04-15 07:06:25,294 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:06:25,294 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:06:25,941 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:06:25,941 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:06:25,951 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:06:26,888 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:06:26,888 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:06:26,888 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:06:27,069 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:06:27,069 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:06:27,070 - root - INFO - reading file of format csv from oltp
2024-04-15 07:06:27,070 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:06:27,070 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:06:29,508 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:06:29,508 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:06:29,509 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:06:29,628 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:06:29,628 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:06:29,628 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:06:30,042 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:06:30,042 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:06:30,042 - root - INFO - implementing data_processing
2024-04-15 07:06:30,042 - Processing - WARNING - data clean method started
2024-04-15 07:06:30,042 - Processing - WARNING - data clean method started
2024-04-15 07:06:40,680 - Processing - WARNING - data cleaning completed
2024-04-15 07:06:40,680 - Processing - WARNING - data cleaning completed
2024-04-15 07:06:43,278 - root - INFO - I am in the main method
2024-04-15 07:06:43,279 - root - INFO - Calling spark object
2024-04-15 07:06:43,279 - Create_spark - INFO - Creating spark object
2024-04-15 07:06:43,279 - Create_spark - INFO - Creating spark object
2024-04-15 07:06:43,279 - Create_spark - INFO - master is local
2024-04-15 07:06:43,279 - Create_spark - INFO - master is local
2024-04-15 07:06:49,630 - Create_spark - INFO - Spark object created
2024-04-15 07:06:49,630 - Create_spark - INFO - Spark object created
2024-04-15 07:06:49,630 - root - INFO - Validating spark object
2024-04-15 07:06:49,630 - Validate - WARNING - Started the spark object validation
2024-04-15 07:06:49,630 - Validate - WARNING - Started the spark object validation
2024-04-15 07:06:50,179 - Validate - WARNING - Validation completed
2024-04-15 07:06:50,179 - Validate - WARNING - Validation completed
2024-04-15 07:06:50,179 - root - INFO - reading file of format parquet from olap
2024-04-15 07:06:50,179 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:06:50,179 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:06:50,709 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:06:50,709 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:06:50,719 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:06:51,631 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:06:51,631 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:06:51,631 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:06:51,808 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:06:51,808 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:06:51,809 - root - INFO - reading file of format csv from oltp
2024-04-15 07:06:51,809 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:06:51,809 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:06:54,160 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:06:54,160 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:06:54,161 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:06:54,257 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:06:54,257 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:06:54,257 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:06:54,608 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:06:54,608 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:06:54,608 - root - INFO - implementing data_processing
2024-04-15 07:06:54,608 - Processing - WARNING - data clean method started
2024-04-15 07:06:54,608 - Processing - WARNING - data clean method started
2024-04-15 07:07:05,214 - Processing - WARNING - data cleaning completed
2024-04-15 07:07:05,214 - Processing - WARNING - data cleaning completed
2024-04-15 07:07:05,215 - root - INFO - the process time  21.94 seconds
2024-04-15 07:07:05,215 - root - INFO - Application done
2024-04-15 07:08:59,660 - root - INFO - I am in the main method
2024-04-15 07:08:59,661 - root - INFO - Calling spark object
2024-04-15 07:08:59,661 - Create_spark - INFO - Creating spark object
2024-04-15 07:08:59,661 - Create_spark - INFO - Creating spark object
2024-04-15 07:08:59,661 - Create_spark - INFO - master is local
2024-04-15 07:08:59,661 - Create_spark - INFO - master is local
2024-04-15 07:09:06,500 - Create_spark - INFO - Spark object created
2024-04-15 07:09:06,500 - Create_spark - INFO - Spark object created
2024-04-15 07:09:06,500 - root - INFO - Validating spark object
2024-04-15 07:09:06,500 - Validate - WARNING - Started the spark object validation
2024-04-15 07:09:06,500 - Validate - WARNING - Started the spark object validation
2024-04-15 07:09:07,143 - Validate - WARNING - Validation completed
2024-04-15 07:09:07,143 - Validate - WARNING - Validation completed
2024-04-15 07:09:07,144 - root - INFO - reading file of format parquet from olap
2024-04-15 07:09:07,144 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:09:07,144 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:09:07,973 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:09:07,973 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:09:07,983 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:09:09,259 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:09:09,259 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:09:09,259 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:09:09,494 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:09:09,494 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:09:09,494 - root - INFO - reading file of format csv from oltp
2024-04-15 07:09:09,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:09:09,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:09:14,684 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:09:14,684 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:09:14,686 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:09:14,779 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:09:14,779 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:09:14,779 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:09:17,149 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:09:17,149 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:09:17,149 - root - INFO - implementing data_processing
2024-04-15 07:09:17,150 - Processing - WARNING - data clean method started
2024-04-15 07:09:17,150 - Processing - WARNING - data clean method started
2024-04-15 07:09:33,576 - Processing - WARNING - data cleaning completed
2024-04-15 07:09:33,576 - Processing - WARNING - data cleaning completed
2024-04-15 07:09:39,817 - root - INFO - the process time  40.16 seconds
2024-04-15 07:09:39,817 - root - INFO - Application done
2024-04-15 07:10:19,989 - root - INFO - I am in the main method
2024-04-15 07:10:19,989 - root - INFO - Calling spark object
2024-04-15 07:10:19,989 - Create_spark - INFO - Creating spark object
2024-04-15 07:10:19,989 - Create_spark - INFO - Creating spark object
2024-04-15 07:10:19,989 - Create_spark - INFO - master is local
2024-04-15 07:10:19,989 - Create_spark - INFO - master is local
2024-04-15 07:10:26,435 - Create_spark - INFO - Spark object created
2024-04-15 07:10:26,435 - Create_spark - INFO - Spark object created
2024-04-15 07:10:26,435 - root - INFO - Validating spark object
2024-04-15 07:10:26,435 - Validate - WARNING - Started the spark object validation
2024-04-15 07:10:26,435 - Validate - WARNING - Started the spark object validation
2024-04-15 07:10:26,994 - Validate - WARNING - Validation completed
2024-04-15 07:10:26,994 - Validate - WARNING - Validation completed
2024-04-15 07:10:26,995 - root - INFO - reading file of format parquet from olap
2024-04-15 07:10:26,995 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:10:26,995 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:10:27,585 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:10:27,585 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:10:27,594 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:10:28,541 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:10:28,541 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:10:28,541 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:10:28,741 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:10:28,741 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:10:28,741 - root - INFO - reading file of format csv from oltp
2024-04-15 07:10:28,741 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:10:28,741 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:10:33,506 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:10:33,506 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:10:33,507 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:10:33,588 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:10:33,588 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:10:33,588 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:10:35,949 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:10:35,949 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:10:35,950 - root - INFO - implementing data_processing
2024-04-15 07:10:35,950 - Processing - WARNING - data clean method started
2024-04-15 07:10:35,950 - Processing - WARNING - data clean method started
2024-04-15 07:10:51,370 - Processing - WARNING - data cleaning completed
2024-04-15 07:10:51,370 - Processing - WARNING - data cleaning completed
2024-04-15 07:10:51,459 - root - INFO - checking schema
2024-04-15 07:10:51,459 - Processing - WARNING - printing schema
2024-04-15 07:10:51,459 - Processing - WARNING - printing schema
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:10:51,459 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - print schema completed
2024-04-15 07:10:51,460 - Processing - INFO - print schema completed
2024-04-15 07:10:51,460 - Processing - WARNING - printing schema
2024-04-15 07:10:51,460 - Processing - WARNING - printing schema
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:10:51,460 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:10:51,460 - Processing - INFO - print schema completed
2024-04-15 07:10:51,460 - Processing - INFO - print schema completed
2024-04-15 07:10:51,460 - root - INFO - creating view
2024-04-15 07:10:51,460 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:10:51,460 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:10:51,475 - Transformation - WARNING - views created successfully
2024-04-15 07:10:51,475 - Transformation - WARNING - views created successfully
2024-04-15 07:10:51,475 - root - INFO - Calculating Insights
2024-04-15 07:10:51,475 - root - INFO - Calculating total zips count in city view
2024-04-15 07:10:51,535 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:10:51,535 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:10:51,535 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:10:51,535 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:11:41,483 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:11:41,483 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:11:41,484 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:11:41,484 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:12:32,713 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:12:32,713 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:12:32,713 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:12:32,713 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:13:24,479 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:13:24,479 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:13:24,479 - root - INFO - the process time  184.49 seconds
2024-04-15 07:13:24,479 - root - INFO - Application done
2024-04-15 07:13:29,712 - root - INFO - I am in the main method
2024-04-15 07:13:29,713 - root - INFO - Calling spark object
2024-04-15 07:13:29,713 - Create_spark - INFO - Creating spark object
2024-04-15 07:13:29,713 - Create_spark - INFO - Creating spark object
2024-04-15 07:13:29,713 - Create_spark - INFO - master is local
2024-04-15 07:13:29,713 - Create_spark - INFO - master is local
2024-04-15 07:13:36,166 - Create_spark - INFO - Spark object created
2024-04-15 07:13:36,166 - Create_spark - INFO - Spark object created
2024-04-15 07:13:36,166 - root - INFO - Validating spark object
2024-04-15 07:13:36,166 - Validate - WARNING - Started the spark object validation
2024-04-15 07:13:36,166 - Validate - WARNING - Started the spark object validation
2024-04-15 07:13:36,717 - Validate - WARNING - Validation completed
2024-04-15 07:13:36,717 - Validate - WARNING - Validation completed
2024-04-15 07:13:36,718 - root - INFO - reading file of format parquet from olap
2024-04-15 07:13:36,718 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:13:36,718 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:13:37,380 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:13:37,380 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:13:37,391 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:13:38,425 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:13:38,425 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:13:38,425 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:13:38,653 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:13:38,653 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:13:38,653 - root - INFO - reading file of format csv from oltp
2024-04-15 07:13:38,653 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:13:38,653 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:13:41,149 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:13:41,149 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:13:41,151 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:13:41,246 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:13:41,246 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:13:41,246 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:13:41,684 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:13:41,684 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:13:41,685 - root - INFO - implementing data_processing
2024-04-15 07:13:41,685 - Processing - WARNING - data clean method started
2024-04-15 07:13:41,685 - Processing - WARNING - data clean method started
2024-04-15 07:13:52,945 - Processing - WARNING - data cleaning completed
2024-04-15 07:13:52,945 - Processing - WARNING - data cleaning completed
2024-04-15 07:13:53,056 - root - INFO - checking schema
2024-04-15 07:13:53,056 - Processing - WARNING - printing schema
2024-04-15 07:13:53,056 - Processing - WARNING - printing schema
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:13:53,057 - Processing - INFO - print schema completed
2024-04-15 07:13:53,057 - Processing - INFO - print schema completed
2024-04-15 07:13:53,057 - Processing - WARNING - printing schema
2024-04-15 07:13:53,057 - Processing - WARNING - printing schema
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:13:53,058 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:13:53,058 - Processing - INFO - print schema completed
2024-04-15 07:13:53,058 - Processing - INFO - print schema completed
2024-04-15 07:13:53,058 - root - INFO - creating view
2024-04-15 07:13:53,058 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:13:53,058 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:13:53,075 - Transformation - WARNING - views created successfully
2024-04-15 07:13:53,075 - Transformation - WARNING - views created successfully
2024-04-15 07:13:53,075 - root - INFO - Calculating Insights
2024-04-15 07:13:53,075 - root - INFO - Calculating total zips count in city view
2024-04-15 07:13:53,127 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:13:53,127 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:13:53,127 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:13:53,127 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:13:56,764 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:13:56,764 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:13:56,764 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:13:56,764 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:14:00,295 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:14:00,295 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:14:00,295 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:14:00,295 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:14:04,539 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:14:04,539 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:14:04,539 - root - INFO - the process time  34.83 seconds
2024-04-15 07:14:04,539 - root - INFO - Application done
2024-04-15 07:14:27,746 - root - INFO - I am in the main method
2024-04-15 07:14:27,746 - root - INFO - Calling spark object
2024-04-15 07:14:27,746 - Create_spark - INFO - Creating spark object
2024-04-15 07:14:27,746 - Create_spark - INFO - Creating spark object
2024-04-15 07:14:27,746 - Create_spark - INFO - master is local
2024-04-15 07:14:27,746 - Create_spark - INFO - master is local
2024-04-15 07:14:34,223 - Create_spark - INFO - Spark object created
2024-04-15 07:14:34,223 - Create_spark - INFO - Spark object created
2024-04-15 07:14:34,223 - root - INFO - Validating spark object
2024-04-15 07:14:34,223 - Validate - WARNING - Started the spark object validation
2024-04-15 07:14:34,223 - Validate - WARNING - Started the spark object validation
2024-04-15 07:14:34,774 - Validate - WARNING - Validation completed
2024-04-15 07:14:34,774 - Validate - WARNING - Validation completed
2024-04-15 07:14:34,775 - root - INFO - reading file of format parquet from olap
2024-04-15 07:14:34,775 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:14:34,775 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:14:35,623 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:14:35,623 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:14:35,633 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:14:36,799 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:14:36,799 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:14:36,799 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:14:36,970 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:14:36,970 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:14:36,971 - root - INFO - reading file of format csv from oltp
2024-04-15 07:14:36,971 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:14:36,971 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:14:40,055 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:14:40,055 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:14:40,057 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:14:40,156 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:14:40,156 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:14:40,156 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:14:40,787 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:14:40,787 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:14:40,787 - root - INFO - implementing data_processing
2024-04-15 07:14:40,787 - Processing - WARNING - data clean method started
2024-04-15 07:14:40,787 - Processing - WARNING - data clean method started
2024-04-15 07:14:52,031 - Processing - WARNING - data cleaning completed
2024-04-15 07:14:52,031 - Processing - WARNING - data cleaning completed
2024-04-15 07:14:52,139 - root - INFO - checking schema
2024-04-15 07:14:52,139 - Processing - WARNING - printing schema
2024-04-15 07:14:52,139 - Processing - WARNING - printing schema
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:14:52,139 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - print schema completed
2024-04-15 07:14:52,140 - Processing - INFO - print schema completed
2024-04-15 07:14:52,140 - Processing - WARNING - printing schema
2024-04-15 07:14:52,140 - Processing - WARNING - printing schema
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:14:52,140 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:14:52,140 - Processing - INFO - print schema completed
2024-04-15 07:14:52,140 - Processing - INFO - print schema completed
2024-04-15 07:14:52,140 - root - INFO - creating view
2024-04-15 07:14:52,140 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:14:52,140 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:14:52,156 - Transformation - WARNING - views created successfully
2024-04-15 07:14:52,156 - Transformation - WARNING - views created successfully
2024-04-15 07:14:52,156 - root - INFO - Calculating Insights
2024-04-15 07:14:52,156 - root - INFO - Calculating total zips count in city view
2024-04-15 07:14:52,208 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:14:52,208 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:14:52,208 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:14:52,208 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:15:00,048 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:15:00,048 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:15:00,049 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:15:00,049 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:15:08,067 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:15:08,067 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:15:08,068 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:15:08,068 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:15:16,435 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:15:16,435 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:15:16,435 - root - INFO - the process time  48.69 seconds
2024-04-15 07:15:16,435 - root - INFO - Application done
2024-04-15 07:15:29,355 - root - INFO - I am in the main method
2024-04-15 07:15:29,355 - root - INFO - Calling spark object
2024-04-15 07:15:29,355 - Create_spark - INFO - Creating spark object
2024-04-15 07:15:29,355 - Create_spark - INFO - Creating spark object
2024-04-15 07:15:29,355 - Create_spark - INFO - master is local
2024-04-15 07:15:29,355 - Create_spark - INFO - master is local
2024-04-15 07:15:35,832 - Create_spark - INFO - Spark object created
2024-04-15 07:15:35,832 - Create_spark - INFO - Spark object created
2024-04-15 07:15:35,832 - root - INFO - Validating spark object
2024-04-15 07:15:35,832 - Validate - WARNING - Started the spark object validation
2024-04-15 07:15:35,832 - Validate - WARNING - Started the spark object validation
2024-04-15 07:15:36,400 - Validate - WARNING - Validation completed
2024-04-15 07:15:36,400 - Validate - WARNING - Validation completed
2024-04-15 07:15:36,401 - root - INFO - reading file of format parquet from olap
2024-04-15 07:15:36,401 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:15:36,401 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:15:36,991 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:15:36,991 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:15:37,000 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:15:37,932 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:15:37,932 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:15:37,932 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:15:38,096 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:15:38,096 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:15:38,097 - root - INFO - reading file of format csv from oltp
2024-04-15 07:15:38,097 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:15:38,097 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:15:40,535 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:15:40,535 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:15:40,537 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:15:40,636 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:15:40,636 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:15:40,636 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:15:41,038 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:15:41,038 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:15:41,038 - root - INFO - implementing data_processing
2024-04-15 07:15:41,038 - Processing - WARNING - data clean method started
2024-04-15 07:15:41,038 - Processing - WARNING - data clean method started
2024-04-15 07:15:51,661 - Processing - WARNING - data cleaning completed
2024-04-15 07:15:51,661 - Processing - WARNING - data cleaning completed
2024-04-15 07:15:53,418 - root - INFO - checking schema
2024-04-15 07:15:53,418 - Processing - WARNING - printing schema
2024-04-15 07:15:53,418 - Processing - WARNING - printing schema
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:15:53,420 - Processing - INFO - print schema completed
2024-04-15 07:15:53,420 - Processing - INFO - print schema completed
2024-04-15 07:15:53,420 - Processing - WARNING - printing schema
2024-04-15 07:15:53,420 - Processing - WARNING - printing schema
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:15:53,421 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:15:53,422 - Processing - INFO - print schema completed
2024-04-15 07:15:53,422 - Processing - INFO - print schema completed
2024-04-15 07:15:53,422 - root - INFO - creating view
2024-04-15 07:15:53,422 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:15:53,422 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:15:53,442 - Transformation - WARNING - views created successfully
2024-04-15 07:15:53,442 - Transformation - WARNING - views created successfully
2024-04-15 07:15:53,443 - root - INFO - Calculating Insights
2024-04-15 07:15:53,443 - root - INFO - Calculating total zips count in city view
2024-04-15 07:15:53,506 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:15:53,506 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:15:53,506 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:15:53,506 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:15:56,869 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:15:56,869 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:15:56,870 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:15:56,870 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:16:00,278 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:16:00,278 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:16:00,278 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:16:00,278 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:16:04,241 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:16:04,241 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:16:04,242 - root - INFO - the process time  34.89 seconds
2024-04-15 07:16:04,242 - root - INFO - Application done
2024-04-15 07:17:47,419 - root - INFO - I am in the main method
2024-04-15 07:17:47,420 - root - INFO - Calling spark object
2024-04-15 07:17:47,420 - Create_spark - INFO - Creating spark object
2024-04-15 07:17:47,420 - Create_spark - INFO - Creating spark object
2024-04-15 07:17:47,420 - Create_spark - INFO - master is local
2024-04-15 07:17:47,420 - Create_spark - INFO - master is local
2024-04-15 07:17:54,274 - Create_spark - INFO - Spark object created
2024-04-15 07:17:54,274 - Create_spark - INFO - Spark object created
2024-04-15 07:17:54,274 - root - INFO - Validating spark object
2024-04-15 07:17:54,274 - Validate - WARNING - Started the spark object validation
2024-04-15 07:17:54,274 - Validate - WARNING - Started the spark object validation
2024-04-15 07:17:54,902 - Validate - WARNING - Validation completed
2024-04-15 07:17:54,902 - Validate - WARNING - Validation completed
2024-04-15 07:17:54,903 - root - INFO - reading file of format parquet from olap
2024-04-15 07:17:54,903 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:17:54,903 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:17:55,538 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:17:55,538 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:17:55,549 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:17:56,491 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:17:56,491 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:17:56,491 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:17:56,649 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:17:56,649 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:17:56,649 - root - INFO - reading file of format csv from oltp
2024-04-15 07:17:56,649 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:17:56,649 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:17:59,011 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:17:59,011 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:17:59,012 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:17:59,099 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:17:59,099 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:17:59,099 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:17:59,486 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:17:59,486 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:17:59,486 - root - INFO - implementing data_processing
2024-04-15 07:17:59,486 - Processing - WARNING - data clean method started
2024-04-15 07:17:59,486 - Processing - WARNING - data clean method started
2024-04-15 07:18:10,113 - Processing - WARNING - data cleaning completed
2024-04-15 07:18:10,113 - Processing - WARNING - data cleaning completed
2024-04-15 07:18:18,820 - root - INFO - checking schema
2024-04-15 07:18:18,820 - Processing - WARNING - printing schema
2024-04-15 07:18:18,820 - Processing - WARNING - printing schema
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:18:18,821 - Processing - INFO - print schema completed
2024-04-15 07:18:18,821 - Processing - INFO - print schema completed
2024-04-15 07:18:18,821 - Processing - WARNING - printing schema
2024-04-15 07:18:18,821 - Processing - WARNING - printing schema
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:18:18,822 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:18:18,822 - Processing - INFO - print schema completed
2024-04-15 07:18:18,822 - Processing - INFO - print schema completed
2024-04-15 07:18:18,822 - root - INFO - creating view
2024-04-15 07:18:18,822 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:18:18,822 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:18:18,838 - Transformation - WARNING - views created successfully
2024-04-15 07:18:18,838 - Transformation - WARNING - views created successfully
2024-04-15 07:18:18,838 - root - INFO - Calculating Insights
2024-04-15 07:18:18,838 - root - INFO - Calculating total zips count in city view
2024-04-15 07:18:18,889 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:18:18,889 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:18:18,889 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:18:18,889 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:18:21,650 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:18:21,650 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:18:21,650 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:18:21,650 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:18:24,903 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:18:24,903 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:18:24,904 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:18:24,904 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:18:28,393 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:18:28,393 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:18:28,394 - root - INFO - the process time  40.97 seconds
2024-04-15 07:18:28,394 - root - INFO - Application done
2024-04-15 07:19:25,676 - root - INFO - I am in the main method
2024-04-15 07:19:25,676 - root - INFO - Calling spark object
2024-04-15 07:19:25,676 - Create_spark - INFO - Creating spark object
2024-04-15 07:19:25,676 - Create_spark - INFO - Creating spark object
2024-04-15 07:19:25,676 - Create_spark - INFO - master is local
2024-04-15 07:19:25,676 - Create_spark - INFO - master is local
2024-04-15 07:19:32,164 - Create_spark - INFO - Spark object created
2024-04-15 07:19:32,164 - Create_spark - INFO - Spark object created
2024-04-15 07:19:32,165 - root - INFO - Validating spark object
2024-04-15 07:19:32,165 - Validate - WARNING - Started the spark object validation
2024-04-15 07:19:32,165 - Validate - WARNING - Started the spark object validation
2024-04-15 07:19:32,737 - Validate - WARNING - Validation completed
2024-04-15 07:19:32,737 - Validate - WARNING - Validation completed
2024-04-15 07:19:32,738 - root - INFO - reading file of format parquet from olap
2024-04-15 07:19:32,738 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:19:32,738 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:19:33,360 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:19:33,360 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:19:33,370 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:19:34,290 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:19:34,290 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:19:34,290 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:19:34,461 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:19:34,461 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:19:34,461 - root - INFO - reading file of format csv from oltp
2024-04-15 07:19:34,461 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:19:34,461 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:19:36,917 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:19:36,917 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:19:36,919 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:19:37,022 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:19:37,022 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:19:37,022 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:19:37,449 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:19:37,449 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:19:37,449 - root - INFO - implementing data_processing
2024-04-15 07:19:37,449 - Processing - WARNING - data clean method started
2024-04-15 07:19:37,449 - Processing - WARNING - data clean method started
2024-04-15 07:19:48,211 - Processing - WARNING - data cleaning completed
2024-04-15 07:19:48,211 - Processing - WARNING - data cleaning completed
2024-04-15 07:19:58,446 - root - INFO - checking schema
2024-04-15 07:19:58,447 - Processing - WARNING - printing schema
2024-04-15 07:19:58,447 - Processing - WARNING - printing schema
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:19:58,447 - Processing - INFO - print schema completed
2024-04-15 07:19:58,447 - Processing - INFO - print schema completed
2024-04-15 07:19:58,447 - Processing - WARNING - printing schema
2024-04-15 07:19:58,447 - Processing - WARNING - printing schema
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:19:58,448 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:19:58,448 - Processing - INFO - print schema completed
2024-04-15 07:19:58,448 - Processing - INFO - print schema completed
2024-04-15 07:19:58,448 - root - INFO - creating view
2024-04-15 07:19:58,448 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:19:58,448 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:19:58,464 - Transformation - WARNING - views created successfully
2024-04-15 07:19:58,464 - Transformation - WARNING - views created successfully
2024-04-15 07:19:58,464 - root - INFO - Calculating Insights
2024-04-15 07:19:58,464 - root - INFO - Calculating total zips count in city view
2024-04-15 07:19:58,534 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:19:58,534 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:19:58,534 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:19:58,534 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:20:01,686 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:20:01,686 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:20:01,687 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:20:01,687 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:20:05,244 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:20:05,244 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:20:05,244 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:20:05,244 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:20:09,490 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:20:09,490 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:20:09,490 - root - INFO - the process time  43.81 seconds
2024-04-15 07:20:09,490 - root - INFO - Application done
2024-04-15 07:21:03,830 - root - INFO - I am in the main method
2024-04-15 07:21:03,830 - root - INFO - Calling spark object
2024-04-15 07:21:03,830 - Create_spark - INFO - Creating spark object
2024-04-15 07:21:03,830 - Create_spark - INFO - Creating spark object
2024-04-15 07:21:03,830 - Create_spark - INFO - master is local
2024-04-15 07:21:03,830 - Create_spark - INFO - master is local
2024-04-15 07:21:10,293 - Create_spark - INFO - Spark object created
2024-04-15 07:21:10,293 - Create_spark - INFO - Spark object created
2024-04-15 07:21:10,293 - root - INFO - Validating spark object
2024-04-15 07:21:10,293 - Validate - WARNING - Started the spark object validation
2024-04-15 07:21:10,293 - Validate - WARNING - Started the spark object validation
2024-04-15 07:21:10,845 - Validate - WARNING - Validation completed
2024-04-15 07:21:10,845 - Validate - WARNING - Validation completed
2024-04-15 07:21:10,845 - root - INFO - reading file of format parquet from olap
2024-04-15 07:21:10,845 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:21:10,845 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:21:11,440 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:21:11,440 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:21:11,450 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:21:12,638 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:21:12,638 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:21:12,638 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:21:12,826 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:21:12,826 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:21:12,826 - root - INFO - reading file of format csv from oltp
2024-04-15 07:21:12,826 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:21:12,826 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:21:15,275 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:21:15,275 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:21:35,982 - root - INFO - I am in the main method
2024-04-15 07:21:35,982 - root - INFO - Calling spark object
2024-04-15 07:21:35,982 - Create_spark - INFO - Creating spark object
2024-04-15 07:21:35,982 - Create_spark - INFO - Creating spark object
2024-04-15 07:21:35,982 - Create_spark - INFO - master is local
2024-04-15 07:21:35,982 - Create_spark - INFO - master is local
2024-04-15 07:21:42,430 - Create_spark - INFO - Spark object created
2024-04-15 07:21:42,430 - Create_spark - INFO - Spark object created
2024-04-15 07:21:42,430 - root - INFO - Validating spark object
2024-04-15 07:21:42,430 - Validate - WARNING - Started the spark object validation
2024-04-15 07:21:42,430 - Validate - WARNING - Started the spark object validation
2024-04-15 07:21:42,983 - Validate - WARNING - Validation completed
2024-04-15 07:21:42,983 - Validate - WARNING - Validation completed
2024-04-15 07:21:42,984 - root - INFO - reading file of format parquet from olap
2024-04-15 07:21:42,984 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:21:42,984 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:21:43,518 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:21:43,518 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:21:43,528 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:21:44,455 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:21:44,455 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:21:44,455 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:21:44,627 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:21:44,627 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:21:44,627 - root - INFO - reading file of format csv from oltp
2024-04-15 07:21:44,627 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:21:44,627 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:21:47,096 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:21:47,096 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:21:47,097 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:21:47,197 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:21:47,198 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:21:47,198 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:21:47,601 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:21:47,601 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:21:47,601 - root - INFO - implementing data_processing
2024-04-15 07:21:47,601 - Processing - WARNING - data clean method started
2024-04-15 07:21:47,601 - Processing - WARNING - data clean method started
2024-04-15 07:21:58,386 - Processing - WARNING - data cleaning completed
2024-04-15 07:21:58,386 - Processing - WARNING - data cleaning completed
2024-04-15 07:22:07,209 - root - INFO - checking schema
2024-04-15 07:22:07,210 - Processing - WARNING - printing schema
2024-04-15 07:22:07,210 - Processing - WARNING - printing schema
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:22:07,210 - Processing - INFO - print schema completed
2024-04-15 07:22:07,210 - Processing - INFO - print schema completed
2024-04-15 07:22:07,210 - Processing - WARNING - printing schema
2024-04-15 07:22:07,210 - Processing - WARNING - printing schema
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:22:07,211 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:22:07,211 - Processing - INFO - print schema completed
2024-04-15 07:22:07,211 - Processing - INFO - print schema completed
2024-04-15 07:22:07,211 - root - INFO - creating view
2024-04-15 07:22:07,211 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:22:07,211 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:22:07,226 - Transformation - WARNING - views created successfully
2024-04-15 07:22:07,226 - Transformation - WARNING - views created successfully
2024-04-15 07:22:07,226 - root - INFO - Calculating Insights
2024-04-15 07:22:07,226 - root - INFO - Calculating total zips count in city view
2024-04-15 07:22:07,276 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:22:07,276 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:22:07,276 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:22:07,276 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:22:09,742 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:22:09,742 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:22:09,742 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:22:09,742 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:22:13,207 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:22:13,207 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:22:13,207 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:22:13,207 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:22:17,451 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:22:17,451 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:22:17,452 - root - INFO - the process time  41.47 seconds
2024-04-15 07:22:17,452 - root - INFO - Application done
2024-04-15 07:22:40,725 - root - INFO - I am in the main method
2024-04-15 07:22:40,725 - root - INFO - Calling spark object
2024-04-15 07:22:40,725 - Create_spark - INFO - Creating spark object
2024-04-15 07:22:40,725 - Create_spark - INFO - Creating spark object
2024-04-15 07:22:40,725 - Create_spark - INFO - master is local
2024-04-15 07:22:40,725 - Create_spark - INFO - master is local
2024-04-15 07:22:47,090 - Create_spark - INFO - Spark object created
2024-04-15 07:22:47,090 - Create_spark - INFO - Spark object created
2024-04-15 07:22:47,091 - root - INFO - Validating spark object
2024-04-15 07:22:47,091 - Validate - WARNING - Started the spark object validation
2024-04-15 07:22:47,091 - Validate - WARNING - Started the spark object validation
2024-04-15 07:22:47,654 - Validate - WARNING - Validation completed
2024-04-15 07:22:47,654 - Validate - WARNING - Validation completed
2024-04-15 07:22:47,655 - root - INFO - reading file of format parquet from olap
2024-04-15 07:22:47,655 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:22:47,655 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 07:22:48,225 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:22:48,225 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 07:22:48,234 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:22:49,146 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 07:22:49,146 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:22:49,146 - Ingest - WARNING - counting number of records for df_city
2024-04-15 07:22:49,311 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:22:49,311 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 07:22:49,312 - root - INFO - reading file of format csv from oltp
2024-04-15 07:22:49,312 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:22:49,312 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 07:22:51,604 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:22:51,604 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 07:22:51,606 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:22:51,704 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 07:22:51,704 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:22:51,704 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 07:22:52,054 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:22:52,054 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 07:22:52,054 - root - INFO - implementing data_processing
2024-04-15 07:22:52,054 - Processing - WARNING - data clean method started
2024-04-15 07:22:52,054 - Processing - WARNING - data clean method started
2024-04-15 07:23:02,707 - Processing - WARNING - data cleaning completed
2024-04-15 07:23:02,707 - Processing - WARNING - data cleaning completed
2024-04-15 07:23:11,042 - root - INFO - checking schema
2024-04-15 07:23:11,043 - Processing - WARNING - printing schema
2024-04-15 07:23:11,043 - Processing - WARNING - printing schema
2024-04-15 07:23:11,043 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:23:11,043 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - print schema completed
2024-04-15 07:23:11,044 - Processing - INFO - print schema completed
2024-04-15 07:23:11,044 - Processing - WARNING - printing schema
2024-04-15 07:23:11,044 - Processing - WARNING - printing schema
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:23:11,044 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 07:23:11,044 - Processing - INFO - print schema completed
2024-04-15 07:23:11,044 - Processing - INFO - print schema completed
2024-04-15 07:23:11,044 - root - INFO - creating view
2024-04-15 07:23:11,044 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:23:11,044 - Transformation - WARNING - creating view from the dataframes
2024-04-15 07:23:11,062 - Transformation - WARNING - views created successfully
2024-04-15 07:23:11,062 - Transformation - WARNING - views created successfully
2024-04-15 07:23:11,062 - root - INFO - Calculating Insights
2024-04-15 07:23:11,062 - root - INFO - Calculating total zips count in city view
2024-04-15 07:23:11,113 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:23:11,113 - Transformation - WARNING - zips count calculated successfully
2024-04-15 07:23:11,113 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:23:11,113 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 07:23:13,439 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:23:13,439 - Transformation - WARNING - presc_report calculation successful
2024-04-15 07:23:13,440 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:23:13,440 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 07:23:16,810 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:23:16,810 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 07:23:16,810 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:23:16,810 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 07:23:20,963 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:23:20,963 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 07:23:20,963 - root - INFO - the process time  40.24 seconds
2024-04-15 07:23:20,963 - root - INFO - Application done
2024-04-15 08:03:47,075 - root - INFO - I am in the main method
2024-04-15 08:03:47,076 - root - INFO - Calling spark object
2024-04-15 08:03:47,076 - Create_spark - INFO - Creating spark object
2024-04-15 08:03:47,076 - Create_spark - INFO - Creating spark object
2024-04-15 08:03:47,076 - Create_spark - INFO - master is local
2024-04-15 08:03:47,076 - Create_spark - INFO - master is local
2024-04-15 08:03:53,865 - Create_spark - INFO - Spark object created
2024-04-15 08:03:53,865 - Create_spark - INFO - Spark object created
2024-04-15 08:03:53,865 - root - INFO - Validating spark object
2024-04-15 08:03:53,865 - Validate - WARNING - Started the spark object validation
2024-04-15 08:03:53,865 - Validate - WARNING - Started the spark object validation
2024-04-15 08:03:54,493 - Validate - WARNING - Validation completed
2024-04-15 08:03:54,493 - Validate - WARNING - Validation completed
2024-04-15 08:03:54,494 - root - INFO - reading file of format parquet from olap
2024-04-15 08:03:54,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 08:03:54,494 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 08:03:55,125 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 08:03:55,125 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 08:03:55,135 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 08:03:56,375 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 08:03:56,375 - Ingest - WARNING - counting number of records for df_city
2024-04-15 08:03:56,375 - Ingest - WARNING - counting number of records for df_city
2024-04-15 08:03:56,538 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 08:03:56,538 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 08:03:56,538 - root - INFO - reading file of format csv from oltp
2024-04-15 08:03:56,538 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 08:03:56,538 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 08:03:58,938 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 08:03:58,938 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 08:03:58,939 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 08:03:59,037 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 08:03:59,037 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 08:03:59,037 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 08:03:59,482 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 08:03:59,482 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 08:03:59,482 - root - INFO - implementing data_processing
2024-04-15 08:03:59,482 - Processing - WARNING - data clean method started
2024-04-15 08:03:59,482 - Processing - WARNING - data clean method started
2024-04-15 08:04:10,493 - Processing - WARNING - data cleaning completed
2024-04-15 08:04:10,493 - Processing - WARNING - data cleaning completed
2024-04-15 08:04:10,598 - root - INFO - checking schema
2024-04-15 08:04:10,598 - Processing - WARNING - printing schema
2024-04-15 08:04:10,598 - Processing - WARNING - printing schema
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - print schema completed
2024-04-15 08:04:10,599 - Processing - INFO - print schema completed
2024-04-15 08:04:10,599 - Processing - WARNING - printing schema
2024-04-15 08:04:10,599 - Processing - WARNING - printing schema
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 08:04:10,599 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 08:04:10,600 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 08:04:10,600 - Processing - INFO - print schema completed
2024-04-15 08:04:10,600 - Processing - INFO - print schema completed
2024-04-15 08:04:10,600 - root - INFO - creating view
2024-04-15 08:04:10,600 - Transformation - WARNING - creating view from the dataframes
2024-04-15 08:04:10,600 - Transformation - WARNING - creating view from the dataframes
2024-04-15 08:04:10,616 - Transformation - WARNING - views created successfully
2024-04-15 08:04:10,616 - Transformation - WARNING - views created successfully
2024-04-15 08:04:10,616 - root - INFO - Calculating Insights
2024-04-15 08:04:10,616 - root - INFO - Calculating total zips count in city view
2024-04-15 08:04:10,668 - Transformation - WARNING - zips count calculated successfully
2024-04-15 08:04:10,668 - Transformation - WARNING - zips count calculated successfully
2024-04-15 08:04:10,668 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 08:04:10,668 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 08:04:14,049 - Transformation - WARNING - presc_report calculation successful
2024-04-15 08:04:14,049 - Transformation - WARNING - presc_report calculation successful
2024-04-15 08:04:14,049 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 08:04:14,049 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 08:04:17,446 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 08:04:17,446 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 08:04:17,446 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 08:04:17,446 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 08:04:21,874 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 08:04:21,874 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 08:04:21,875 - root - INFO - saving file
2024-04-15 08:04:21,875 - root - WARNING - saving files started...
2024-04-15 08:04:21,875 - Saving - ERROR - an error occurred while saving the file
2024-04-15 08:04:21,875 - Saving - ERROR - an error occurred while saving the file
2024-04-15 08:04:58,479 - root - INFO - I am in the main method
2024-04-15 08:04:58,479 - root - INFO - Calling spark object
2024-04-15 08:04:58,479 - Create_spark - INFO - Creating spark object
2024-04-15 08:04:58,479 - Create_spark - INFO - Creating spark object
2024-04-15 08:04:58,479 - Create_spark - INFO - master is local
2024-04-15 08:04:58,479 - Create_spark - INFO - master is local
2024-04-15 08:05:04,955 - Create_spark - INFO - Spark object created
2024-04-15 08:05:04,955 - Create_spark - INFO - Spark object created
2024-04-15 08:05:04,955 - root - INFO - Validating spark object
2024-04-15 08:05:04,955 - Validate - WARNING - Started the spark object validation
2024-04-15 08:05:04,955 - Validate - WARNING - Started the spark object validation
2024-04-15 08:05:05,520 - Validate - WARNING - Validation completed
2024-04-15 08:05:05,520 - Validate - WARNING - Validation completed
2024-04-15 08:05:05,521 - root - INFO - reading file of format parquet from olap
2024-04-15 08:05:05,521 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 08:05:05,521 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/olap/us_cities_dimension.parquet
2024-04-15 08:05:06,127 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 08:05:06,127 - Ingest - WARNING - dataframe created successfully of parquet format
2024-04-15 08:05:06,136 - root - INFO - displaying dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 08:05:07,070 - root - INFO - validating the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-04-15 08:05:07,070 - Ingest - WARNING - counting number of records for df_city
2024-04-15 08:05:07,070 - Ingest - WARNING - counting number of records for df_city
2024-04-15 08:05:07,233 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 08:05:07,233 - Ingest - WARNING - counted the records for df_city -> 28338 successfully
2024-04-15 08:05:07,233 - root - INFO - reading file of format csv from oltp
2024-04-15 08:05:07,233 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 08:05:07,233 - Ingest - WARNING - load_files method started for /Users/pratikrathi/Desktop/PySpark/Project_Pharmaceuticals/source/oltp/USA_Presc_Medicare_Data_12021.csv
2024-04-15 08:05:09,645 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 08:05:09,645 - Ingest - WARNING - dataframe created successfully of csv format
2024-04-15 08:05:09,646 - root - INFO - displaying dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 08:05:09,743 - root - INFO - validating the dataframe DataFrame[npi: int, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: int, total_claim_count: int, total_30_day_fill_count: double, total_day_supply: int, total_drug_cost: double, bene_count_ge65: int, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: int, ge65_suppress_flag: string, total_30_day_fill_count_ge65: double, total_day_supply_ge65: int, total_drug_cost_ge65: double, years_of_exp: string]
2024-04-15 08:05:09,744 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 08:05:09,744 - Ingest - WARNING - counting number of records for df_fact
2024-04-15 08:05:10,165 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 08:05:10,165 - Ingest - WARNING - counted the records for df_fact -> 1329329 successfully
2024-04-15 08:05:10,165 - root - INFO - implementing data_processing
2024-04-15 08:05:10,165 - Processing - WARNING - data clean method started
2024-04-15 08:05:10,165 - Processing - WARNING - data clean method started
2024-04-15 08:05:20,856 - Processing - WARNING - data cleaning completed
2024-04-15 08:05:20,856 - Processing - WARNING - data cleaning completed
2024-04-15 08:05:20,953 - root - INFO - checking schema
2024-04-15 08:05:20,953 - Processing - WARNING - printing schema
2024-04-15 08:05:20,953 - Processing - WARNING - printing schema
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('city', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('state_id', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('state_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('county_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('population', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('zips', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - print schema completed
2024-04-15 08:05:20,954 - Processing - INFO - print schema completed
2024-04-15 08:05:20,954 - Processing - WARNING - printing schema
2024-04-15 08:05:20,954 - Processing - WARNING - printing schema
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_id', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_city', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_state', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_speciaility', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('drug_name', StringType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_claim_count', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_day_supply', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('total_drug_cost', DoubleType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('country_name', StringType(), False)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 08:05:20,954 - Processing - INFO - 	StructField('presc_name', StringType(), False)
2024-04-15 08:05:20,954 - Processing - INFO - print schema completed
2024-04-15 08:05:20,954 - Processing - INFO - print schema completed
2024-04-15 08:05:20,954 - root - INFO - creating view
2024-04-15 08:05:20,955 - Transformation - WARNING - creating view from the dataframes
2024-04-15 08:05:20,955 - Transformation - WARNING - creating view from the dataframes
2024-04-15 08:05:20,975 - Transformation - WARNING - views created successfully
2024-04-15 08:05:20,975 - Transformation - WARNING - views created successfully
2024-04-15 08:05:20,975 - root - INFO - Calculating Insights
2024-04-15 08:05:20,975 - root - INFO - Calculating total zips count in city view
2024-04-15 08:05:20,996 - Transformation - WARNING - zips count calculated successfully
2024-04-15 08:05:20,996 - Transformation - WARNING - zips count calculated successfully
2024-04-15 08:05:20,996 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 08:05:20,996 - Transformation - INFO - Calculating presc aggregations by state, city in presc view
2024-04-15 08:05:24,346 - Transformation - WARNING - presc_report calculation successful
2024-04-15 08:05:24,346 - Transformation - WARNING - presc_report calculation successful
2024-04-15 08:05:24,346 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 08:05:24,346 - Transformation - INFO - Calculating cities with prescribers
2024-04-15 08:05:27,755 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 08:05:27,755 - Transformation - WARNING - cities with prescribers calculation successful
2024-04-15 08:05:27,755 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 08:05:27,755 - Transformation - INFO - Calculating presc aggregations by state for top 5 
2024-04-15 08:05:27,792 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 08:05:27,792 - Transformation - WARNING - presc aggregations by state for top 5 calculation successful
2024-04-15 08:05:27,792 - root - INFO - saving file
2024-04-15 08:05:27,792 - root - WARNING - saving files started...
2024-04-15 08:05:28,152 - Saving - WARNING - files saved successfully
2024-04-15 08:05:28,152 - Saving - WARNING - files saved successfully
2024-04-15 08:05:28,152 - root - WARNING - saving files started...
2024-04-15 08:05:32,320 - Saving - WARNING - files saved successfully
2024-04-15 08:05:32,320 - Saving - WARNING - files saved successfully
2024-04-15 08:05:32,320 - root - INFO - the process time  33.84 seconds
2024-04-15 08:05:32,320 - root - INFO - Application done
